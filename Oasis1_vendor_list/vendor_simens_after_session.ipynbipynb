{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b44cb6f4-5dee-45ab-89d0-4f6c8f442591",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_roi_dict = {\n",
    "    'Left-Cingulate': {\n",
    "        'ctx-lh-caudalanteriorcingulate',\n",
    "        'ctx-lh-rostralanteriorcingulate',\n",
    "        'ctx-lh-isthmuscingulate',\n",
    "        'ctx-lh-posteriorcingulate',\n",
    "    },\n",
    "    'Right-Cingulate': {\n",
    "        'ctx-rh-caudalanteriorcingulate',\n",
    "        'ctx-rh-rostralanteriorcingulate',\n",
    "        'ctx-rh-isthmuscingulate',\n",
    "        'ctx-rh-posteriorcingulate',\n",
    "    },\n",
    "    'Left-Frontal': {\n",
    "        'ctx-lh-caudalmiddlefrontal',\n",
    "        'ctx-lh-lateralorbitofrontal',\n",
    "        'ctx-lh-medialorbitofrontal',\n",
    "        'ctx-lh-parsopercularis',\n",
    "        'ctx-lh-parsorbitalis',\n",
    "        'ctx-lh-parstriangularis',\n",
    "        'ctx-lh-precentral',\n",
    "        'ctx-lh-rostralmiddlefrontal',\n",
    "        'ctx-lh-superiorfrontal',\n",
    "        'ctx-lh-paracentral'\n",
    "    },\n",
    "    'Right-Frontal': {\n",
    "        'ctx-rh-caudalmiddlefrontal',\n",
    "        'ctx-rh-lateralorbitofrontal',\n",
    "        'ctx-rh-medialorbitofrontal',\n",
    "        'ctx-rh-parsopercularis',\n",
    "        'ctx-rh-parsorbitalis',\n",
    "        'ctx-rh-parstriangularis',\n",
    "        'ctx-rh-precentral',\n",
    "        'ctx-rh-rostralmiddlefrontal',\n",
    "        'ctx-rh-superiorfrontal',\n",
    "        'ctx-rh-paracentral'\n",
    "    },\n",
    "    'Left-Temporal': {\n",
    "        'ctx-lh-entorhinal',\n",
    "        'ctx-lh-fusiform',\n",
    "        'ctx-lh-inferiortemporal',\n",
    "        'ctx-lh-middletemporal',\n",
    "        'ctx-lh-superiortemporal',\n",
    "        'ctx-lh-transversetemporal',\n",
    "        'ctx-lh-parahippocampal',\n",
    "        \n",
    "    },\n",
    "    'Right-Temporal': {\n",
    "        'ctx-rh-entorhinal',\n",
    "        'ctx-rh-fusiform',\n",
    "        'ctx-rh-inferiortemporal',\n",
    "        'ctx-rh-middletemporal',\n",
    "        'ctx-rh-superiortemporal',\n",
    "        'ctx-rh-transversetemporal',\n",
    "        'ctx-rh-parahippocampal',\n",
    "     \n",
    "    },\n",
    "    'Left-Parietal': {\n",
    "        'ctx-lh-inferiorparietal',\n",
    "        'ctx-lh-postcentral',\n",
    "        'ctx-lh-superiorparietal',\n",
    "        'ctx-lh-supramarginal',\n",
    "        'ctx-lh-precuneus'\n",
    "    },\n",
    "    'Right-Parietal': {\n",
    "        'ctx-rh-inferiorparietal',\n",
    "        'ctx-rh-postcentral',\n",
    "        'ctx-rh-superiorparietal',\n",
    "        'ctx-rh-supramarginal',\n",
    "        'ctx-rh-precuneus'\n",
    "    },\n",
    "    'Left-Occipital': {\n",
    "        'ctx-lh-cuneus',\n",
    "        'ctx-lh-lateraloccipital',\n",
    "        'ctx-lh-lingual',\n",
    "        'ctx-lh-pericalcarine'\n",
    "    },\n",
    "    'Right-Occipital': {\n",
    "        'ctx-rh-cuneus',\n",
    "        'ctx-rh-lateraloccipital',\n",
    "        'ctx-rh-lingual',\n",
    "        'ctx-rh-pericalcarine'\n",
    "    },\n",
    "    'Left-Insula':{\n",
    "        'ctx-lh-insula'\n",
    "    },\n",
    "    'Right-Insula': {\n",
    "        'ctx-rh-insula'\n",
    "    },\n",
    "    'Left-Cerebellum':{\n",
    "        'Left-Cerebellum-White-Matter',\n",
    "        'Left-Cerebellum-Cortex'\n",
    "    },\n",
    "    'Right-Cerebellum': {\n",
    "        'Right-Cerebellum-White-Matter',\n",
    "        'Right-Cerebellum-Cortex'\n",
    "    },\n",
    "    'Left-Combined-Cerebral-WM': {\n",
    "        'Left-Cerebral-White-Matter',\n",
    "        'Left-WM-hypointensities'\n",
    "    },\n",
    "    'Right-Combined-Cerebral-WM': {\n",
    "        'Right-Cerebral-White-Matter',\n",
    "        'Right-WM-hypointensities'\n",
    "    },\n",
    "    'Left-Total-Lateral-Ventricle': {\n",
    "        'Left-Lateral-Ventricle',\n",
    "        'Left-Inf-Lat-Vent'\n",
    "    },\n",
    "    'Right-Total-Lateral-Ventricle': {\n",
    "        'Right-Lateral-Ventricle',\n",
    "        'Right-Inf-Lat-Vent'\n",
    "    },\n",
    "}\n",
    "gray_matter_index = {\n",
    "    'left_cortical_gm': {\n",
    "        'left_cingulate',\n",
    "        'left_frontal',\n",
    "        'left_temporal',\n",
    "        'left_parietal',\n",
    "        'left_occipital',\n",
    "        'left_insula'\n",
    "    },\n",
    "    'right_cortical_gm': {\n",
    "        'right_cingulate',\n",
    "        'right_frontal',\n",
    "        'right_temporal',\n",
    "        'right_parietal',\n",
    "        'right_occipital',\n",
    "        'right_insula'\n",
    "    }\n",
    "}\n",
    "\n",
    "combined_roi_display_dict = {\n",
    "    'Left-Cingulate': {\n",
    "        'ctx-lh-caudalanteriorcingulate',\n",
    "        'ctx-lh-rostralanteriorcingulate',\n",
    "        'ctx-lh-isthmuscingulate',\n",
    "        'ctx-lh-posteriorcingulate',\n",
    "    },\n",
    "    'Right-Cingulate': {\n",
    "        'ctx-rh-caudalanteriorcingulate',\n",
    "        'ctx-rh-rostralanteriorcingulate',\n",
    "        'ctx-rh-isthmuscingulate',\n",
    "        'ctx-rh-posteriorcingulate',\n",
    "    },\n",
    "    'Left-Frontal': {\n",
    "        'ctx-lh-caudalmiddlefrontal',\n",
    "        'ctx-lh-lateralorbitofrontal',\n",
    "        'ctx-lh-medialorbitofrontal',\n",
    "        'ctx-lh-parsopercularis',\n",
    "        'ctx-lh-parsorbitalis',\n",
    "        'ctx-lh-parstriangularis',\n",
    "        'ctx-lh-precentral',\n",
    "        'ctx-lh-rostralmiddlefrontal',\n",
    "        'ctx-lh-superiorfrontal',\n",
    "        'ctx-lh-paracentral'\n",
    "    },\n",
    "    'Right-Frontal': {\n",
    "        'ctx-rh-caudalmiddlefrontal',\n",
    "        'ctx-rh-lateralorbitofrontal',\n",
    "        'ctx-rh-medialorbitofrontal',\n",
    "        'ctx-rh-parsopercularis',\n",
    "        'ctx-rh-parsorbitalis',\n",
    "        'ctx-rh-parstriangularis',\n",
    "        'ctx-rh-precentral',\n",
    "        'ctx-rh-rostralmiddlefrontal',\n",
    "        'ctx-rh-superiorfrontal',\n",
    "        'ctx-rh-paracentral'\n",
    "    },\n",
    "    'Left-Temporal': {\n",
    "        'ctx-lh-entorhinal',\n",
    "        'ctx-lh-fusiform',\n",
    "        'ctx-lh-inferiortemporal',\n",
    "        'ctx-lh-middletemporal',\n",
    "        'ctx-lh-superiortemporal',\n",
    "        'ctx-lh-transversetemporal',\n",
    "        'ctx-lh-parahippocampal',\n",
    "    },\n",
    "    'Right-Temporal': {\n",
    "        'ctx-rh-entorhinal',\n",
    "        'ctx-rh-fusiform',\n",
    "        'ctx-rh-inferiortemporal',\n",
    "        'ctx-rh-middletemporal',\n",
    "        'ctx-rh-superiortemporal',\n",
    "        'ctx-rh-transversetemporal',\n",
    "        'ctx-rh-parahippocampal',\n",
    "    },\n",
    "    'Left-Parietal': {\n",
    "        'ctx-lh-inferiorparietal',\n",
    "        'ctx-lh-postcentral',\n",
    "        'ctx-lh-superiorparietal',\n",
    "        'ctx-lh-supramarginal',\n",
    "        'ctx-lh-precuneus'\n",
    "    },\n",
    "    'Right-Parietal': {\n",
    "        'ctx-rh-inferiorparietal',\n",
    "        'ctx-rh-postcentral',\n",
    "        'ctx-rh-superiorparietal',\n",
    "        'ctx-rh-supramarginal',\n",
    "        'ctx-rh-precuneus'\n",
    "    },\n",
    "    'Left-Occipital': {\n",
    "        'ctx-lh-cuneus',\n",
    "        'ctx-lh-lateraloccipital',\n",
    "        'ctx-lh-lingual',\n",
    "        'ctx-lh-pericalcarine'\n",
    "    },\n",
    "    'Right-Occipital': {\n",
    "        'ctx-rh-cuneus',\n",
    "        'ctx-rh-lateraloccipital',\n",
    "        'ctx-rh-lingual',\n",
    "        'ctx-rh-pericalcarine'\n",
    "    },\n",
    "    'Left-Insula':{\n",
    "        'ctx-lh-insula'\n",
    "    },\n",
    "    'Right-Insula': {\n",
    "        'ctx-rh-insula'\n",
    "    },\n",
    "    'Left-Cerebellum':{\n",
    "        'Left-Cerebellum-White-Matter',\n",
    "        'Left-Cerebellum-Cortex'\n",
    "    },\n",
    "    'Right-Cerebellum': {\n",
    "        'Right-Cerebellum-White-Matter',\n",
    "        'Right-Cerebellum-Cortex'\n",
    "    },\n",
    "    'Left-Combined-Cerebral-WM': {\n",
    "        'Left-Cerebral-White-Matter',\n",
    "        'Left-WM-hypointensities'\n",
    "    },\n",
    "    'Right-Combined-Cerebral-WM': {\n",
    "        'Right-Cerebral-White-Matter',\n",
    "        'Right-WM-hypointensities'\n",
    "    }\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "76edebac-5ac9-408a-99f6-1e1d36692fd8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_3198212/1034284564.py:3: DeprecationWarning: \n",
      "Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),\n",
      "(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)\n",
      "but was not found to be installed on your system.\n",
      "If this would cause problems for you,\n",
      "please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466\n",
      "        \n",
      "  import pandas as pd\n"
     ]
    }
   ],
   "source": [
    "import nibabel as nib\n",
    "import numpy as np\n",
    "import pandas as pd\n",
    "import os\n",
    "import glob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "fa52e795-2db0-4a4c-a67a-aae4fca00b0b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/BNU_1'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7175d019-7439-4656-9bf7-ac21bebe7149",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import pandas as pd\n",
    "\n",
    "\n",
    "\n",
    "volume_data = []\n",
    "\n",
    "for subject_dir in os.listdir(base_dir):\n",
    "    full_subject_dir = os.path.join(base_dir, subject_dir)\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data.append(vol_data)\n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df = pd.DataFrame(volume_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "33c3766a-576e-4100-a837-b6b0311e522e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>...</th>\n",
       "      <th>2025</th>\n",
       "      <th>2026</th>\n",
       "      <th>2027</th>\n",
       "      <th>2028</th>\n",
       "      <th>2029</th>\n",
       "      <th>2030</th>\n",
       "      <th>2031</th>\n",
       "      <th>2034</th>\n",
       "      <th>2035</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.553251e+07</td>\n",
       "      <td>251189.872159</td>\n",
       "      <td>6081.046907</td>\n",
       "      <td>401.309994</td>\n",
       "      <td>15394.182765</td>\n",
       "      <td>55528.612151</td>\n",
       "      <td>9159.128860</td>\n",
       "      <td>4682.635928</td>\n",
       "      <td>5694.828913</td>\n",
       "      <td>2335.829964</td>\n",
       "      <td>...</td>\n",
       "      <td>12952.022802</td>\n",
       "      <td>2971.408955</td>\n",
       "      <td>13208.929798</td>\n",
       "      <td>32447.456504</td>\n",
       "      <td>12067.082815</td>\n",
       "      <td>17070.080739</td>\n",
       "      <td>10020.744847</td>\n",
       "      <td>869.504987</td>\n",
       "      <td>7042.475892</td>\n",
       "      <td>0025920_session_1_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.546629e+07</td>\n",
       "      <td>265756.052936</td>\n",
       "      <td>5002.654923</td>\n",
       "      <td>512.098992</td>\n",
       "      <td>15963.905756</td>\n",
       "      <td>60626.278073</td>\n",
       "      <td>9271.975858</td>\n",
       "      <td>3975.369939</td>\n",
       "      <td>6631.904899</td>\n",
       "      <td>2450.391963</td>\n",
       "      <td>...</td>\n",
       "      <td>11891.809818</td>\n",
       "      <td>3347.336949</td>\n",
       "      <td>13707.994790</td>\n",
       "      <td>32073.243510</td>\n",
       "      <td>11288.472827</td>\n",
       "      <td>18410.867718</td>\n",
       "      <td>11608.491822</td>\n",
       "      <td>1303.742980</td>\n",
       "      <td>7043.161892</td>\n",
       "      <td>0025867_session_2_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.561655e+07</td>\n",
       "      <td>235089.795405</td>\n",
       "      <td>4865.454926</td>\n",
       "      <td>413.657994</td>\n",
       "      <td>15524.522763</td>\n",
       "      <td>54854.274161</td>\n",
       "      <td>9007.179862</td>\n",
       "      <td>3727.380943</td>\n",
       "      <td>5566.203915</td>\n",
       "      <td>2381.791964</td>\n",
       "      <td>...</td>\n",
       "      <td>11149.900829</td>\n",
       "      <td>2554.663961</td>\n",
       "      <td>12894.398803</td>\n",
       "      <td>27923.286573</td>\n",
       "      <td>11177.683829</td>\n",
       "      <td>15206.904767</td>\n",
       "      <td>9221.211859</td>\n",
       "      <td>1025.569984</td>\n",
       "      <td>6242.256905</td>\n",
       "      <td>0025906_session_2_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.558112e+07</td>\n",
       "      <td>245575.648245</td>\n",
       "      <td>7304.870888</td>\n",
       "      <td>634.892990</td>\n",
       "      <td>13274.442797</td>\n",
       "      <td>54781.558162</td>\n",
       "      <td>8651.831868</td>\n",
       "      <td>3521.923946</td>\n",
       "      <td>5828.941911</td>\n",
       "      <td>2140.319967</td>\n",
       "      <td>...</td>\n",
       "      <td>12011.516816</td>\n",
       "      <td>2225.726966</td>\n",
       "      <td>12406.995810</td>\n",
       "      <td>27671.181577</td>\n",
       "      <td>10340.077842</td>\n",
       "      <td>15839.396758</td>\n",
       "      <td>9998.792847</td>\n",
       "      <td>905.519986</td>\n",
       "      <td>5892.053910</td>\n",
       "      <td>0025905_session_1_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.570087e+07</td>\n",
       "      <td>207922.823820</td>\n",
       "      <td>4490.212931</td>\n",
       "      <td>450.358993</td>\n",
       "      <td>12461.189809</td>\n",
       "      <td>47562.094273</td>\n",
       "      <td>7758.659881</td>\n",
       "      <td>4071.752938</td>\n",
       "      <td>5717.809913</td>\n",
       "      <td>2337.201964</td>\n",
       "      <td>...</td>\n",
       "      <td>11715.164821</td>\n",
       "      <td>3090.772953</td>\n",
       "      <td>11672.632822</td>\n",
       "      <td>27574.798578</td>\n",
       "      <td>10771.571835</td>\n",
       "      <td>15594.837762</td>\n",
       "      <td>10592.868838</td>\n",
       "      <td>968.288985</td>\n",
       "      <td>6437.766902</td>\n",
       "      <td>0025889_session_2_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>1.573016e+07</td>\n",
       "      <td>204341.903875</td>\n",
       "      <td>12933.157802</td>\n",
       "      <td>371.125994</td>\n",
       "      <td>12422.430810</td>\n",
       "      <td>47055.826280</td>\n",
       "      <td>7326.822888</td>\n",
       "      <td>3909.170940</td>\n",
       "      <td>5130.593922</td>\n",
       "      <td>2104.304968</td>\n",
       "      <td>...</td>\n",
       "      <td>10652.893837</td>\n",
       "      <td>1903.649971</td>\n",
       "      <td>10073.909846</td>\n",
       "      <td>26126.652600</td>\n",
       "      <td>11304.936827</td>\n",
       "      <td>13761.845790</td>\n",
       "      <td>10989.719832</td>\n",
       "      <td>921.983986</td>\n",
       "      <td>6357.847903</td>\n",
       "      <td>0025869_session_1_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>1.556405e+07</td>\n",
       "      <td>238217.269357</td>\n",
       "      <td>8359.595872</td>\n",
       "      <td>350.202995</td>\n",
       "      <td>14062.656785</td>\n",
       "      <td>60066.502081</td>\n",
       "      <td>8876.839864</td>\n",
       "      <td>4838.357926</td>\n",
       "      <td>6833.245896</td>\n",
       "      <td>2521.049961</td>\n",
       "      <td>...</td>\n",
       "      <td>13257.635797</td>\n",
       "      <td>2378.361964</td>\n",
       "      <td>12853.581803</td>\n",
       "      <td>30264.947537</td>\n",
       "      <td>12304.781812</td>\n",
       "      <td>16954.146741</td>\n",
       "      <td>10639.516837</td>\n",
       "      <td>1215.934981</td>\n",
       "      <td>7352.890888</td>\n",
       "      <td>0025899_session_1_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>1.557285e+07</td>\n",
       "      <td>228928.143499</td>\n",
       "      <td>11104.281830</td>\n",
       "      <td>554.973992</td>\n",
       "      <td>15610.615761</td>\n",
       "      <td>57449.755121</td>\n",
       "      <td>8674.812867</td>\n",
       "      <td>4149.613937</td>\n",
       "      <td>5340.166918</td>\n",
       "      <td>2254.538966</td>\n",
       "      <td>...</td>\n",
       "      <td>11547.094823</td>\n",
       "      <td>2149.923967</td>\n",
       "      <td>10090.373846</td>\n",
       "      <td>30662.141531</td>\n",
       "      <td>12172.040814</td>\n",
       "      <td>17473.105733</td>\n",
       "      <td>10644.318837</td>\n",
       "      <td>904.833986</td>\n",
       "      <td>6506.366901</td>\n",
       "      <td>0025868_session_2_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>1.556975e+07</td>\n",
       "      <td>228625.960504</td>\n",
       "      <td>11490.499824</td>\n",
       "      <td>570.065991</td>\n",
       "      <td>15539.271762</td>\n",
       "      <td>57183.244126</td>\n",
       "      <td>8762.277866</td>\n",
       "      <td>4202.092936</td>\n",
       "      <td>5278.769919</td>\n",
       "      <td>2274.775965</td>\n",
       "      <td>...</td>\n",
       "      <td>11808.803819</td>\n",
       "      <td>2190.397967</td>\n",
       "      <td>10283.482843</td>\n",
       "      <td>30923.850527</td>\n",
       "      <td>12207.712813</td>\n",
       "      <td>17496.086732</td>\n",
       "      <td>10449.494840</td>\n",
       "      <td>885.625986</td>\n",
       "      <td>6466.235901</td>\n",
       "      <td>0025868_session_1_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100</th>\n",
       "      <td>1.550924e+07</td>\n",
       "      <td>256858.633072</td>\n",
       "      <td>5548.367915</td>\n",
       "      <td>312.472995</td>\n",
       "      <td>16103.506754</td>\n",
       "      <td>57494.345121</td>\n",
       "      <td>9923.675848</td>\n",
       "      <td>4012.756939</td>\n",
       "      <td>6081.732907</td>\n",
       "      <td>2341.317964</td>\n",
       "      <td>...</td>\n",
       "      <td>12995.926801</td>\n",
       "      <td>2884.972956</td>\n",
       "      <td>11947.032817</td>\n",
       "      <td>30040.625541</td>\n",
       "      <td>12115.445815</td>\n",
       "      <td>19862.786696</td>\n",
       "      <td>11466.832825</td>\n",
       "      <td>1437.512978</td>\n",
       "      <td>7467.109886</td>\n",
       "      <td>0025908_session_2_anat_1_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>101 rows × 97 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                0              2             4           5             7  \\\n",
       "0    1.553251e+07  251189.872159   6081.046907  401.309994  15394.182765   \n",
       "1    1.546629e+07  265756.052936   5002.654923  512.098992  15963.905756   \n",
       "2    1.561655e+07  235089.795405   4865.454926  413.657994  15524.522763   \n",
       "3    1.558112e+07  245575.648245   7304.870888  634.892990  13274.442797   \n",
       "4    1.570087e+07  207922.823820   4490.212931  450.358993  12461.189809   \n",
       "..            ...            ...           ...         ...           ...   \n",
       "96   1.573016e+07  204341.903875  12933.157802  371.125994  12422.430810   \n",
       "97   1.556405e+07  238217.269357   8359.595872  350.202995  14062.656785   \n",
       "98   1.557285e+07  228928.143499  11104.281830  554.973992  15610.615761   \n",
       "99   1.556975e+07  228625.960504  11490.499824  570.065991  15539.271762   \n",
       "100  1.550924e+07  256858.633072   5548.367915  312.472995  16103.506754   \n",
       "\n",
       "                8           10           11           12           13  ...  \\\n",
       "0    55528.612151  9159.128860  4682.635928  5694.828913  2335.829964  ...   \n",
       "1    60626.278073  9271.975858  3975.369939  6631.904899  2450.391963  ...   \n",
       "2    54854.274161  9007.179862  3727.380943  5566.203915  2381.791964  ...   \n",
       "3    54781.558162  8651.831868  3521.923946  5828.941911  2140.319967  ...   \n",
       "4    47562.094273  7758.659881  4071.752938  5717.809913  2337.201964  ...   \n",
       "..            ...          ...          ...          ...          ...  ...   \n",
       "96   47055.826280  7326.822888  3909.170940  5130.593922  2104.304968  ...   \n",
       "97   60066.502081  8876.839864  4838.357926  6833.245896  2521.049961  ...   \n",
       "98   57449.755121  8674.812867  4149.613937  5340.166918  2254.538966  ...   \n",
       "99   57183.244126  8762.277866  4202.092936  5278.769919  2274.775965  ...   \n",
       "100  57494.345121  9923.675848  4012.756939  6081.732907  2341.317964  ...   \n",
       "\n",
       "             2025         2026          2027          2028          2029  \\\n",
       "0    12952.022802  2971.408955  13208.929798  32447.456504  12067.082815   \n",
       "1    11891.809818  3347.336949  13707.994790  32073.243510  11288.472827   \n",
       "2    11149.900829  2554.663961  12894.398803  27923.286573  11177.683829   \n",
       "3    12011.516816  2225.726966  12406.995810  27671.181577  10340.077842   \n",
       "4    11715.164821  3090.772953  11672.632822  27574.798578  10771.571835   \n",
       "..            ...          ...           ...           ...           ...   \n",
       "96   10652.893837  1903.649971  10073.909846  26126.652600  11304.936827   \n",
       "97   13257.635797  2378.361964  12853.581803  30264.947537  12304.781812   \n",
       "98   11547.094823  2149.923967  10090.373846  30662.141531  12172.040814   \n",
       "99   11808.803819  2190.397967  10283.482843  30923.850527  12207.712813   \n",
       "100  12995.926801  2884.972956  11947.032817  30040.625541  12115.445815   \n",
       "\n",
       "             2030          2031         2034         2035  \\\n",
       "0    17070.080739  10020.744847   869.504987  7042.475892   \n",
       "1    18410.867718  11608.491822  1303.742980  7043.161892   \n",
       "2    15206.904767   9221.211859  1025.569984  6242.256905   \n",
       "3    15839.396758   9998.792847   905.519986  5892.053910   \n",
       "4    15594.837762  10592.868838   968.288985  6437.766902   \n",
       "..            ...           ...          ...          ...   \n",
       "96   13761.845790  10989.719832   921.983986  6357.847903   \n",
       "97   16954.146741  10639.516837  1215.934981  7352.890888   \n",
       "98   17473.105733  10644.318837   904.833986  6506.366901   \n",
       "99   17496.086732  10449.494840   885.625986  6466.235901   \n",
       "100  19862.786696  11466.832825  1437.512978  7467.109886   \n",
       "\n",
       "                                               subject  \n",
       "0    0025920_session_1_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "1    0025867_session_2_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "2    0025906_session_2_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "3    0025905_session_1_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "4    0025889_session_2_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "..                                                 ...  \n",
       "96   0025869_session_1_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "97   0025899_session_1_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "98   0025868_session_2_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "99   0025868_session_1_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "100  0025908_session_2_anat_1_Tag_pr100_sr100_ppf10...  \n",
       "\n",
       "[101 rows x 97 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "volume_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "98787fa6-7b02-4b41-9188-2dcab3ea08e4",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df['subject'] = volume_df['subject'].str.replace('_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf190_FS222', '')\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "e66325f4-162c-4f22-bd59-6e2cacaa5295",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>...</th>\n",
       "      <th>2025</th>\n",
       "      <th>2026</th>\n",
       "      <th>2027</th>\n",
       "      <th>2028</th>\n",
       "      <th>2029</th>\n",
       "      <th>2030</th>\n",
       "      <th>2031</th>\n",
       "      <th>2034</th>\n",
       "      <th>2035</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.553251e+07</td>\n",
       "      <td>251189.872159</td>\n",
       "      <td>6081.046907</td>\n",
       "      <td>401.309994</td>\n",
       "      <td>15394.182765</td>\n",
       "      <td>55528.612151</td>\n",
       "      <td>9159.128860</td>\n",
       "      <td>4682.635928</td>\n",
       "      <td>5694.828913</td>\n",
       "      <td>2335.829964</td>\n",
       "      <td>...</td>\n",
       "      <td>12952.022802</td>\n",
       "      <td>2971.408955</td>\n",
       "      <td>13208.929798</td>\n",
       "      <td>32447.456504</td>\n",
       "      <td>12067.082815</td>\n",
       "      <td>17070.080739</td>\n",
       "      <td>10020.744847</td>\n",
       "      <td>869.504987</td>\n",
       "      <td>7042.475892</td>\n",
       "      <td>0025920_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.546629e+07</td>\n",
       "      <td>265756.052936</td>\n",
       "      <td>5002.654923</td>\n",
       "      <td>512.098992</td>\n",
       "      <td>15963.905756</td>\n",
       "      <td>60626.278073</td>\n",
       "      <td>9271.975858</td>\n",
       "      <td>3975.369939</td>\n",
       "      <td>6631.904899</td>\n",
       "      <td>2450.391963</td>\n",
       "      <td>...</td>\n",
       "      <td>11891.809818</td>\n",
       "      <td>3347.336949</td>\n",
       "      <td>13707.994790</td>\n",
       "      <td>32073.243510</td>\n",
       "      <td>11288.472827</td>\n",
       "      <td>18410.867718</td>\n",
       "      <td>11608.491822</td>\n",
       "      <td>1303.742980</td>\n",
       "      <td>7043.161892</td>\n",
       "      <td>0025867_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.561655e+07</td>\n",
       "      <td>235089.795405</td>\n",
       "      <td>4865.454926</td>\n",
       "      <td>413.657994</td>\n",
       "      <td>15524.522763</td>\n",
       "      <td>54854.274161</td>\n",
       "      <td>9007.179862</td>\n",
       "      <td>3727.380943</td>\n",
       "      <td>5566.203915</td>\n",
       "      <td>2381.791964</td>\n",
       "      <td>...</td>\n",
       "      <td>11149.900829</td>\n",
       "      <td>2554.663961</td>\n",
       "      <td>12894.398803</td>\n",
       "      <td>27923.286573</td>\n",
       "      <td>11177.683829</td>\n",
       "      <td>15206.904767</td>\n",
       "      <td>9221.211859</td>\n",
       "      <td>1025.569984</td>\n",
       "      <td>6242.256905</td>\n",
       "      <td>0025906_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.558112e+07</td>\n",
       "      <td>245575.648245</td>\n",
       "      <td>7304.870888</td>\n",
       "      <td>634.892990</td>\n",
       "      <td>13274.442797</td>\n",
       "      <td>54781.558162</td>\n",
       "      <td>8651.831868</td>\n",
       "      <td>3521.923946</td>\n",
       "      <td>5828.941911</td>\n",
       "      <td>2140.319967</td>\n",
       "      <td>...</td>\n",
       "      <td>12011.516816</td>\n",
       "      <td>2225.726966</td>\n",
       "      <td>12406.995810</td>\n",
       "      <td>27671.181577</td>\n",
       "      <td>10340.077842</td>\n",
       "      <td>15839.396758</td>\n",
       "      <td>9998.792847</td>\n",
       "      <td>905.519986</td>\n",
       "      <td>5892.053910</td>\n",
       "      <td>0025905_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.570087e+07</td>\n",
       "      <td>207922.823820</td>\n",
       "      <td>4490.212931</td>\n",
       "      <td>450.358993</td>\n",
       "      <td>12461.189809</td>\n",
       "      <td>47562.094273</td>\n",
       "      <td>7758.659881</td>\n",
       "      <td>4071.752938</td>\n",
       "      <td>5717.809913</td>\n",
       "      <td>2337.201964</td>\n",
       "      <td>...</td>\n",
       "      <td>11715.164821</td>\n",
       "      <td>3090.772953</td>\n",
       "      <td>11672.632822</td>\n",
       "      <td>27574.798578</td>\n",
       "      <td>10771.571835</td>\n",
       "      <td>15594.837762</td>\n",
       "      <td>10592.868838</td>\n",
       "      <td>968.288985</td>\n",
       "      <td>6437.766902</td>\n",
       "      <td>0025889_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>1.573016e+07</td>\n",
       "      <td>204341.903875</td>\n",
       "      <td>12933.157802</td>\n",
       "      <td>371.125994</td>\n",
       "      <td>12422.430810</td>\n",
       "      <td>47055.826280</td>\n",
       "      <td>7326.822888</td>\n",
       "      <td>3909.170940</td>\n",
       "      <td>5130.593922</td>\n",
       "      <td>2104.304968</td>\n",
       "      <td>...</td>\n",
       "      <td>10652.893837</td>\n",
       "      <td>1903.649971</td>\n",
       "      <td>10073.909846</td>\n",
       "      <td>26126.652600</td>\n",
       "      <td>11304.936827</td>\n",
       "      <td>13761.845790</td>\n",
       "      <td>10989.719832</td>\n",
       "      <td>921.983986</td>\n",
       "      <td>6357.847903</td>\n",
       "      <td>0025869_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>97</th>\n",
       "      <td>1.556405e+07</td>\n",
       "      <td>238217.269357</td>\n",
       "      <td>8359.595872</td>\n",
       "      <td>350.202995</td>\n",
       "      <td>14062.656785</td>\n",
       "      <td>60066.502081</td>\n",
       "      <td>8876.839864</td>\n",
       "      <td>4838.357926</td>\n",
       "      <td>6833.245896</td>\n",
       "      <td>2521.049961</td>\n",
       "      <td>...</td>\n",
       "      <td>13257.635797</td>\n",
       "      <td>2378.361964</td>\n",
       "      <td>12853.581803</td>\n",
       "      <td>30264.947537</td>\n",
       "      <td>12304.781812</td>\n",
       "      <td>16954.146741</td>\n",
       "      <td>10639.516837</td>\n",
       "      <td>1215.934981</td>\n",
       "      <td>7352.890888</td>\n",
       "      <td>0025899_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>98</th>\n",
       "      <td>1.557285e+07</td>\n",
       "      <td>228928.143499</td>\n",
       "      <td>11104.281830</td>\n",
       "      <td>554.973992</td>\n",
       "      <td>15610.615761</td>\n",
       "      <td>57449.755121</td>\n",
       "      <td>8674.812867</td>\n",
       "      <td>4149.613937</td>\n",
       "      <td>5340.166918</td>\n",
       "      <td>2254.538966</td>\n",
       "      <td>...</td>\n",
       "      <td>11547.094823</td>\n",
       "      <td>2149.923967</td>\n",
       "      <td>10090.373846</td>\n",
       "      <td>30662.141531</td>\n",
       "      <td>12172.040814</td>\n",
       "      <td>17473.105733</td>\n",
       "      <td>10644.318837</td>\n",
       "      <td>904.833986</td>\n",
       "      <td>6506.366901</td>\n",
       "      <td>0025868_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>99</th>\n",
       "      <td>1.556975e+07</td>\n",
       "      <td>228625.960504</td>\n",
       "      <td>11490.499824</td>\n",
       "      <td>570.065991</td>\n",
       "      <td>15539.271762</td>\n",
       "      <td>57183.244126</td>\n",
       "      <td>8762.277866</td>\n",
       "      <td>4202.092936</td>\n",
       "      <td>5278.769919</td>\n",
       "      <td>2274.775965</td>\n",
       "      <td>...</td>\n",
       "      <td>11808.803819</td>\n",
       "      <td>2190.397967</td>\n",
       "      <td>10283.482843</td>\n",
       "      <td>30923.850527</td>\n",
       "      <td>12207.712813</td>\n",
       "      <td>17496.086732</td>\n",
       "      <td>10449.494840</td>\n",
       "      <td>885.625986</td>\n",
       "      <td>6466.235901</td>\n",
       "      <td>0025868_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>100</th>\n",
       "      <td>1.550924e+07</td>\n",
       "      <td>256858.633072</td>\n",
       "      <td>5548.367915</td>\n",
       "      <td>312.472995</td>\n",
       "      <td>16103.506754</td>\n",
       "      <td>57494.345121</td>\n",
       "      <td>9923.675848</td>\n",
       "      <td>4012.756939</td>\n",
       "      <td>6081.732907</td>\n",
       "      <td>2341.317964</td>\n",
       "      <td>...</td>\n",
       "      <td>12995.926801</td>\n",
       "      <td>2884.972956</td>\n",
       "      <td>11947.032817</td>\n",
       "      <td>30040.625541</td>\n",
       "      <td>12115.445815</td>\n",
       "      <td>19862.786696</td>\n",
       "      <td>11466.832825</td>\n",
       "      <td>1437.512978</td>\n",
       "      <td>7467.109886</td>\n",
       "      <td>0025908_session_2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>101 rows × 97 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                0              2             4           5             7  \\\n",
       "0    1.553251e+07  251189.872159   6081.046907  401.309994  15394.182765   \n",
       "1    1.546629e+07  265756.052936   5002.654923  512.098992  15963.905756   \n",
       "2    1.561655e+07  235089.795405   4865.454926  413.657994  15524.522763   \n",
       "3    1.558112e+07  245575.648245   7304.870888  634.892990  13274.442797   \n",
       "4    1.570087e+07  207922.823820   4490.212931  450.358993  12461.189809   \n",
       "..            ...            ...           ...         ...           ...   \n",
       "96   1.573016e+07  204341.903875  12933.157802  371.125994  12422.430810   \n",
       "97   1.556405e+07  238217.269357   8359.595872  350.202995  14062.656785   \n",
       "98   1.557285e+07  228928.143499  11104.281830  554.973992  15610.615761   \n",
       "99   1.556975e+07  228625.960504  11490.499824  570.065991  15539.271762   \n",
       "100  1.550924e+07  256858.633072   5548.367915  312.472995  16103.506754   \n",
       "\n",
       "                8           10           11           12           13  ...  \\\n",
       "0    55528.612151  9159.128860  4682.635928  5694.828913  2335.829964  ...   \n",
       "1    60626.278073  9271.975858  3975.369939  6631.904899  2450.391963  ...   \n",
       "2    54854.274161  9007.179862  3727.380943  5566.203915  2381.791964  ...   \n",
       "3    54781.558162  8651.831868  3521.923946  5828.941911  2140.319967  ...   \n",
       "4    47562.094273  7758.659881  4071.752938  5717.809913  2337.201964  ...   \n",
       "..            ...          ...          ...          ...          ...  ...   \n",
       "96   47055.826280  7326.822888  3909.170940  5130.593922  2104.304968  ...   \n",
       "97   60066.502081  8876.839864  4838.357926  6833.245896  2521.049961  ...   \n",
       "98   57449.755121  8674.812867  4149.613937  5340.166918  2254.538966  ...   \n",
       "99   57183.244126  8762.277866  4202.092936  5278.769919  2274.775965  ...   \n",
       "100  57494.345121  9923.675848  4012.756939  6081.732907  2341.317964  ...   \n",
       "\n",
       "             2025         2026          2027          2028          2029  \\\n",
       "0    12952.022802  2971.408955  13208.929798  32447.456504  12067.082815   \n",
       "1    11891.809818  3347.336949  13707.994790  32073.243510  11288.472827   \n",
       "2    11149.900829  2554.663961  12894.398803  27923.286573  11177.683829   \n",
       "3    12011.516816  2225.726966  12406.995810  27671.181577  10340.077842   \n",
       "4    11715.164821  3090.772953  11672.632822  27574.798578  10771.571835   \n",
       "..            ...          ...           ...           ...           ...   \n",
       "96   10652.893837  1903.649971  10073.909846  26126.652600  11304.936827   \n",
       "97   13257.635797  2378.361964  12853.581803  30264.947537  12304.781812   \n",
       "98   11547.094823  2149.923967  10090.373846  30662.141531  12172.040814   \n",
       "99   11808.803819  2190.397967  10283.482843  30923.850527  12207.712813   \n",
       "100  12995.926801  2884.972956  11947.032817  30040.625541  12115.445815   \n",
       "\n",
       "             2030          2031         2034         2035            subject  \n",
       "0    17070.080739  10020.744847   869.504987  7042.475892  0025920_session_1  \n",
       "1    18410.867718  11608.491822  1303.742980  7043.161892  0025867_session_2  \n",
       "2    15206.904767   9221.211859  1025.569984  6242.256905  0025906_session_2  \n",
       "3    15839.396758   9998.792847   905.519986  5892.053910  0025905_session_1  \n",
       "4    15594.837762  10592.868838   968.288985  6437.766902  0025889_session_2  \n",
       "..            ...           ...          ...          ...                ...  \n",
       "96   13761.845790  10989.719832   921.983986  6357.847903  0025869_session_1  \n",
       "97   16954.146741  10639.516837  1215.934981  7352.890888  0025899_session_1  \n",
       "98   17473.105733  10644.318837   904.833986  6506.366901  0025868_session_2  \n",
       "99   17496.086732  10449.494840   885.625986  6466.235901  0025868_session_1  \n",
       "100  19862.786696  11466.832825  1437.512978  7467.109886  0025908_session_2  \n",
       "\n",
       "[101 rows x 97 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "volume_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "a6cd3f77-1bcc-4ea1-81c7-ed64bffe991c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir1 = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/IBATRT'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "60defc42-42c2-432a-9788-046cf63dc044",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_data1 = []\n",
    "\n",
    "for subject_dir in os.listdir(base_dir1):\n",
    "    full_subject_dir = os.path.join(base_dir1, subject_dir)\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data1.append(vol_data)\n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df1 = pd.DataFrame(volume_data1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "d0685634-01a5-4d03-a11d-f191c890467f",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df1['subject'] = volume_df1['subject'].str.replace('_anat_1_Tag_pr100_sr100_ppf75_spf100_ipf100_sipf143_FS222', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "a6771c02-de23-4f5d-b0a6-c14ebc73d25f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>...</th>\n",
       "      <th>2025</th>\n",
       "      <th>2026</th>\n",
       "      <th>2027</th>\n",
       "      <th>2028</th>\n",
       "      <th>2029</th>\n",
       "      <th>2030</th>\n",
       "      <th>2031</th>\n",
       "      <th>2034</th>\n",
       "      <th>2035</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.561815e+07</td>\n",
       "      <td>231869.368454</td>\n",
       "      <td>7730.876882</td>\n",
       "      <td>451.387993</td>\n",
       "      <td>15652.118761</td>\n",
       "      <td>55650.034149</td>\n",
       "      <td>8483.075870</td>\n",
       "      <td>3736.984943</td>\n",
       "      <td>5213.942920</td>\n",
       "      <td>2072.405968</td>\n",
       "      <td>...</td>\n",
       "      <td>10429.600841</td>\n",
       "      <td>2986.843954</td>\n",
       "      <td>13478.870794</td>\n",
       "      <td>25608.036608</td>\n",
       "      <td>9824.205850</td>\n",
       "      <td>14937.649772</td>\n",
       "      <td>10650.835837</td>\n",
       "      <td>856.813987</td>\n",
       "      <td>5313.069919</td>\n",
       "      <td>0027231_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.579113e+07</td>\n",
       "      <td>187520.155132</td>\n",
       "      <td>5686.253913</td>\n",
       "      <td>394.449994</td>\n",
       "      <td>14020.124786</td>\n",
       "      <td>56773.016132</td>\n",
       "      <td>6877.149895</td>\n",
       "      <td>3716.061943</td>\n",
       "      <td>4748.491927</td>\n",
       "      <td>1827.846972</td>\n",
       "      <td>...</td>\n",
       "      <td>8798.978865</td>\n",
       "      <td>2560.837961</td>\n",
       "      <td>8436.084871</td>\n",
       "      <td>20777.224682</td>\n",
       "      <td>9133.060860</td>\n",
       "      <td>16168.676753</td>\n",
       "      <td>9002.034862</td>\n",
       "      <td>867.103987</td>\n",
       "      <td>5518.183916</td>\n",
       "      <td>0027248_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.569809e+07</td>\n",
       "      <td>225365.745554</td>\n",
       "      <td>7635.522883</td>\n",
       "      <td>689.086989</td>\n",
       "      <td>14613.171777</td>\n",
       "      <td>53769.708178</td>\n",
       "      <td>8113.664876</td>\n",
       "      <td>3418.680948</td>\n",
       "      <td>5395.732917</td>\n",
       "      <td>2259.683965</td>\n",
       "      <td>...</td>\n",
       "      <td>10397.701841</td>\n",
       "      <td>2355.380964</td>\n",
       "      <td>8813.384865</td>\n",
       "      <td>22932.293649</td>\n",
       "      <td>9136.147860</td>\n",
       "      <td>14527.078778</td>\n",
       "      <td>9636.927853</td>\n",
       "      <td>1028.999984</td>\n",
       "      <td>5496.231916</td>\n",
       "      <td>0027243_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.568413e+07</td>\n",
       "      <td>226103.538542</td>\n",
       "      <td>7276.744889</td>\n",
       "      <td>683.598990</td>\n",
       "      <td>14505.812778</td>\n",
       "      <td>54083.210173</td>\n",
       "      <td>8261.840874</td>\n",
       "      <td>3442.347947</td>\n",
       "      <td>5378.925918</td>\n",
       "      <td>2259.340965</td>\n",
       "      <td>...</td>\n",
       "      <td>10620.994838</td>\n",
       "      <td>2403.743963</td>\n",
       "      <td>9281.579858</td>\n",
       "      <td>23246.824645</td>\n",
       "      <td>9478.118855</td>\n",
       "      <td>14402.569780</td>\n",
       "      <td>10005.995847</td>\n",
       "      <td>1068.787984</td>\n",
       "      <td>5649.209914</td>\n",
       "      <td>0027243_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.561476e+07</td>\n",
       "      <td>234022.036421</td>\n",
       "      <td>7252.048889</td>\n",
       "      <td>427.720993</td>\n",
       "      <td>15343.761765</td>\n",
       "      <td>54258.483170</td>\n",
       "      <td>8472.442870</td>\n",
       "      <td>3772.999942</td>\n",
       "      <td>5289.745919</td>\n",
       "      <td>2084.067968</td>\n",
       "      <td>...</td>\n",
       "      <td>10508.490839</td>\n",
       "      <td>2965.577955</td>\n",
       "      <td>14002.288786</td>\n",
       "      <td>26600.678593</td>\n",
       "      <td>10009.768847</td>\n",
       "      <td>15001.104771</td>\n",
       "      <td>10855.949834</td>\n",
       "      <td>864.016987</td>\n",
       "      <td>5180.671921</td>\n",
       "      <td>0027231_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1.578504e+07</td>\n",
       "      <td>188339.239120</td>\n",
       "      <td>5403.964917</td>\n",
       "      <td>384.502994</td>\n",
       "      <td>14140.174784</td>\n",
       "      <td>57113.958127</td>\n",
       "      <td>6866.859895</td>\n",
       "      <td>3768.883942</td>\n",
       "      <td>4798.912927</td>\n",
       "      <td>1871.064971</td>\n",
       "      <td>...</td>\n",
       "      <td>9028.102862</td>\n",
       "      <td>2544.373961</td>\n",
       "      <td>8583.231869</td>\n",
       "      <td>20855.085681</td>\n",
       "      <td>9100.132861</td>\n",
       "      <td>16311.707751</td>\n",
       "      <td>9189.655859</td>\n",
       "      <td>912.036986</td>\n",
       "      <td>5584.725915</td>\n",
       "      <td>0027248_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1.563509e+07</td>\n",
       "      <td>238806.886348</td>\n",
       "      <td>11470.605825</td>\n",
       "      <td>394.106994</td>\n",
       "      <td>16221.841752</td>\n",
       "      <td>53983.740174</td>\n",
       "      <td>7891.057879</td>\n",
       "      <td>4023.389938</td>\n",
       "      <td>5894.797910</td>\n",
       "      <td>2167.759967</td>\n",
       "      <td>...</td>\n",
       "      <td>9422.895856</td>\n",
       "      <td>2213.721966</td>\n",
       "      <td>10456.011840</td>\n",
       "      <td>23500.644641</td>\n",
       "      <td>9337.145857</td>\n",
       "      <td>15551.619762</td>\n",
       "      <td>8552.704869</td>\n",
       "      <td>943.935986</td>\n",
       "      <td>6487.501901</td>\n",
       "      <td>0027256_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1.554239e+07</td>\n",
       "      <td>252994.395131</td>\n",
       "      <td>14625.176776</td>\n",
       "      <td>692.516989</td>\n",
       "      <td>14485.232778</td>\n",
       "      <td>55771.456147</td>\n",
       "      <td>8379.832872</td>\n",
       "      <td>4099.878937</td>\n",
       "      <td>6187.719905</td>\n",
       "      <td>2139.633967</td>\n",
       "      <td>...</td>\n",
       "      <td>11109.083830</td>\n",
       "      <td>2341.660964</td>\n",
       "      <td>11842.074819</td>\n",
       "      <td>28484.091564</td>\n",
       "      <td>10437.489840</td>\n",
       "      <td>18995.682710</td>\n",
       "      <td>11221.930828</td>\n",
       "      <td>1269.442981</td>\n",
       "      <td>7119.650891</td>\n",
       "      <td>0027228_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1.554613e+07</td>\n",
       "      <td>251693.396151</td>\n",
       "      <td>14666.679776</td>\n",
       "      <td>713.096989</td>\n",
       "      <td>13976.220786</td>\n",
       "      <td>54821.003162</td>\n",
       "      <td>8265.270874</td>\n",
       "      <td>4099.878937</td>\n",
       "      <td>6086.191907</td>\n",
       "      <td>2192.112966</td>\n",
       "      <td>...</td>\n",
       "      <td>10825.422834</td>\n",
       "      <td>2414.033963</td>\n",
       "      <td>12190.905814</td>\n",
       "      <td>29052.785556</td>\n",
       "      <td>10669.014837</td>\n",
       "      <td>19127.394708</td>\n",
       "      <td>11061.063831</td>\n",
       "      <td>1259.152981</td>\n",
       "      <td>7028.412893</td>\n",
       "      <td>0027228_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1.560914e+07</td>\n",
       "      <td>239381.411339</td>\n",
       "      <td>11462.373825</td>\n",
       "      <td>394.792994</td>\n",
       "      <td>16478.405748</td>\n",
       "      <td>54160.042172</td>\n",
       "      <td>7854.699880</td>\n",
       "      <td>4064.892938</td>\n",
       "      <td>5818.651911</td>\n",
       "      <td>2203.431966</td>\n",
       "      <td>...</td>\n",
       "      <td>10481.736840</td>\n",
       "      <td>2130.372967</td>\n",
       "      <td>10464.929840</td>\n",
       "      <td>24850.349620</td>\n",
       "      <td>10574.689838</td>\n",
       "      <td>16282.895751</td>\n",
       "      <td>9262.714858</td>\n",
       "      <td>977.206985</td>\n",
       "      <td>6652.484898</td>\n",
       "      <td>0027256_session_1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 97 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              0              2             4           5             7  \\\n",
       "0  1.561815e+07  231869.368454   7730.876882  451.387993  15652.118761   \n",
       "1  1.579113e+07  187520.155132   5686.253913  394.449994  14020.124786   \n",
       "2  1.569809e+07  225365.745554   7635.522883  689.086989  14613.171777   \n",
       "3  1.568413e+07  226103.538542   7276.744889  683.598990  14505.812778   \n",
       "4  1.561476e+07  234022.036421   7252.048889  427.720993  15343.761765   \n",
       "5  1.578504e+07  188339.239120   5403.964917  384.502994  14140.174784   \n",
       "6  1.563509e+07  238806.886348  11470.605825  394.106994  16221.841752   \n",
       "7  1.554239e+07  252994.395131  14625.176776  692.516989  14485.232778   \n",
       "8  1.554613e+07  251693.396151  14666.679776  713.096989  13976.220786   \n",
       "9  1.560914e+07  239381.411339  11462.373825  394.792994  16478.405748   \n",
       "\n",
       "              8           10           11           12           13  ...  \\\n",
       "0  55650.034149  8483.075870  3736.984943  5213.942920  2072.405968  ...   \n",
       "1  56773.016132  6877.149895  3716.061943  4748.491927  1827.846972  ...   \n",
       "2  53769.708178  8113.664876  3418.680948  5395.732917  2259.683965  ...   \n",
       "3  54083.210173  8261.840874  3442.347947  5378.925918  2259.340965  ...   \n",
       "4  54258.483170  8472.442870  3772.999942  5289.745919  2084.067968  ...   \n",
       "5  57113.958127  6866.859895  3768.883942  4798.912927  1871.064971  ...   \n",
       "6  53983.740174  7891.057879  4023.389938  5894.797910  2167.759967  ...   \n",
       "7  55771.456147  8379.832872  4099.878937  6187.719905  2139.633967  ...   \n",
       "8  54821.003162  8265.270874  4099.878937  6086.191907  2192.112966  ...   \n",
       "9  54160.042172  7854.699880  4064.892938  5818.651911  2203.431966  ...   \n",
       "\n",
       "           2025         2026          2027          2028          2029  \\\n",
       "0  10429.600841  2986.843954  13478.870794  25608.036608   9824.205850   \n",
       "1   8798.978865  2560.837961   8436.084871  20777.224682   9133.060860   \n",
       "2  10397.701841  2355.380964   8813.384865  22932.293649   9136.147860   \n",
       "3  10620.994838  2403.743963   9281.579858  23246.824645   9478.118855   \n",
       "4  10508.490839  2965.577955  14002.288786  26600.678593  10009.768847   \n",
       "5   9028.102862  2544.373961   8583.231869  20855.085681   9100.132861   \n",
       "6   9422.895856  2213.721966  10456.011840  23500.644641   9337.145857   \n",
       "7  11109.083830  2341.660964  11842.074819  28484.091564  10437.489840   \n",
       "8  10825.422834  2414.033963  12190.905814  29052.785556  10669.014837   \n",
       "9  10481.736840  2130.372967  10464.929840  24850.349620  10574.689838   \n",
       "\n",
       "           2030          2031         2034         2035            subject  \n",
       "0  14937.649772  10650.835837   856.813987  5313.069919  0027231_session_2  \n",
       "1  16168.676753   9002.034862   867.103987  5518.183916  0027248_session_2  \n",
       "2  14527.078778   9636.927853  1028.999984  5496.231916  0027243_session_2  \n",
       "3  14402.569780  10005.995847  1068.787984  5649.209914  0027243_session_1  \n",
       "4  15001.104771  10855.949834   864.016987  5180.671921  0027231_session_1  \n",
       "5  16311.707751   9189.655859   912.036986  5584.725915  0027248_session_1  \n",
       "6  15551.619762   8552.704869   943.935986  6487.501901  0027256_session_2  \n",
       "7  18995.682710  11221.930828  1269.442981  7119.650891  0027228_session_1  \n",
       "8  19127.394708  11061.063831  1259.152981  7028.412893  0027228_session_2  \n",
       "9  16282.895751   9262.714858   977.206985  6652.484898  0027256_session_1  \n",
       "\n",
       "[10 rows x 97 columns]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "volume_df1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "6f7b8cc7-012e-4856-a600-300b56f692f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir2 = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/IPCAS_1'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "1ad54014-fb83-4d38-a41a-17c65791c1bb",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_data2 = []#고치기\n",
    "\n",
    "for subject_dir in os.listdir(base_dir2):# 고치기\n",
    "    full_subject_dir = os.path.join(base_dir2, subject_dir)#고치기\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data2.append(vol_data) #고치기 \n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df2 = pd.DataFrame(volume_data2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "ff1a12d7-8131-4be3-ac80-d361caba197a",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df2['subject'] = volume_df2['subject'].str.replace('_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf190_FS222', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "48a3f466-623d-494c-9091-ceb69e101634",
   "metadata": {},
   "outputs": [],
   "source": [
    "#volume_df2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "e2d25aaa-249a-457d-b70f-d7d103acb116",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir3 = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "56004c0d-200b-41a1-a5eb-5db0b4747094",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027208_session_3_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027208_session_3_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027209_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027209_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027221_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027221_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027216_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027216_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027209_session_1_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027209_session_1_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027208_session_2_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027208_session_2_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027214_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027214_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027221_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027221_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027210_session_3_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027210_session_3_anat_2_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027213_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027213_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027212_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027212_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027220_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027220_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027219_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027219_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027222_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027222_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027215_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027215_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027210_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027210_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027214_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027214_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027216_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027216_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027215_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027215_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027213_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027213_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027213_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027213_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027219_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027219_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027214_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027214_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027219_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027219_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027215_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027215_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027222_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027222_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027221_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027221_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027220_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027220_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027212_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027212_session_3_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027210_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027210_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027220_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027220_session_2_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027222_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027222_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n",
      "File not found, skipped: /home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_1/0027216_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/0027216_session_1_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222/mri/aparc.DKTatlas+aseg.deep.nii.gz\n"
     ]
    }
   ],
   "source": [
    "volume_data3 = []#고치기\n",
    "\n",
    "for subject_dir in os.listdir(base_dir3):# 고치기\n",
    "    full_subject_dir = os.path.join(base_dir3, subject_dir)#고치기\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data3.append(vol_data) #고치기 \n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df3 = pd.DataFrame(volume_data3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9053cd4b-c590-4142-995b-151eaea7962b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#volume_df3 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "0e4453c8-19cb-46b3-817b-62e2bd5929f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df3['subject'] = volume_df3['subject'].str.replace('_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "b53b5934-150f-44ab-83ce-a9359f5e4af3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>...</th>\n",
       "      <th>2025</th>\n",
       "      <th>2026</th>\n",
       "      <th>2027</th>\n",
       "      <th>2028</th>\n",
       "      <th>2029</th>\n",
       "      <th>2030</th>\n",
       "      <th>2031</th>\n",
       "      <th>2034</th>\n",
       "      <th>2035</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.461628e+07</td>\n",
       "      <td>229382.961492</td>\n",
       "      <td>6657.972898</td>\n",
       "      <td>376.270994</td>\n",
       "      <td>15693.964760</td>\n",
       "      <td>61671.742057</td>\n",
       "      <td>8952.985863</td>\n",
       "      <td>3790.149942</td>\n",
       "      <td>6516.313900</td>\n",
       "      <td>2491.551962</td>\n",
       "      <td>...</td>\n",
       "      <td>10991.434832</td>\n",
       "      <td>2993.017954</td>\n",
       "      <td>11598.201823</td>\n",
       "      <td>32107.886509</td>\n",
       "      <td>10237.520843</td>\n",
       "      <td>18619.068715</td>\n",
       "      <td>9259.284858</td>\n",
       "      <td>1126.754983</td>\n",
       "      <td>7135.428891</td>\n",
       "      <td>0027222_session_2_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.478108e+07</td>\n",
       "      <td>188578.310116</td>\n",
       "      <td>5184.787921</td>\n",
       "      <td>327.564995</td>\n",
       "      <td>11849.277819</td>\n",
       "      <td>45861.500299</td>\n",
       "      <td>8209.018874</td>\n",
       "      <td>3629.282945</td>\n",
       "      <td>4737.858928</td>\n",
       "      <td>2017.525969</td>\n",
       "      <td>...</td>\n",
       "      <td>12179.929814</td>\n",
       "      <td>3022.858954</td>\n",
       "      <td>12187.818814</td>\n",
       "      <td>26460.734595</td>\n",
       "      <td>11824.581819</td>\n",
       "      <td>18073.698724</td>\n",
       "      <td>10989.033832</td>\n",
       "      <td>1434.768978</td>\n",
       "      <td>6411.698902</td>\n",
       "      <td>0027214_session_2_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.478631e+07</td>\n",
       "      <td>187827.483128</td>\n",
       "      <td>5450.955917</td>\n",
       "      <td>373.183994</td>\n",
       "      <td>11846.533819</td>\n",
       "      <td>45955.825297</td>\n",
       "      <td>8193.240875</td>\n",
       "      <td>3577.832945</td>\n",
       "      <td>4704.244928</td>\n",
       "      <td>2003.119969</td>\n",
       "      <td>...</td>\n",
       "      <td>12036.555816</td>\n",
       "      <td>2969.350955</td>\n",
       "      <td>12041.700816</td>\n",
       "      <td>26196.967599</td>\n",
       "      <td>11787.194820</td>\n",
       "      <td>18027.393724</td>\n",
       "      <td>10760.938835</td>\n",
       "      <td>1437.169978</td>\n",
       "      <td>6377.398902</td>\n",
       "      <td>0027214_session_1_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.463785e+07</td>\n",
       "      <td>226204.723541</td>\n",
       "      <td>11956.979817</td>\n",
       "      <td>221.920997</td>\n",
       "      <td>13980.679786</td>\n",
       "      <td>58942.491099</td>\n",
       "      <td>8267.328874</td>\n",
       "      <td>4102.279937</td>\n",
       "      <td>5442.380917</td>\n",
       "      <td>2366.699964</td>\n",
       "      <td>...</td>\n",
       "      <td>10938.955833</td>\n",
       "      <td>2500.126962</td>\n",
       "      <td>11846.876819</td>\n",
       "      <td>29088.114555</td>\n",
       "      <td>12553.113808</td>\n",
       "      <td>16824.492743</td>\n",
       "      <td>11385.541826</td>\n",
       "      <td>1070.845984</td>\n",
       "      <td>7051.050892</td>\n",
       "      <td>0027207_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.450475e+07</td>\n",
       "      <td>247010.074223</td>\n",
       "      <td>11198.949829</td>\n",
       "      <td>487.402993</td>\n",
       "      <td>14238.958782</td>\n",
       "      <td>59908.036084</td>\n",
       "      <td>9053.484862</td>\n",
       "      <td>4083.414938</td>\n",
       "      <td>6573.251899</td>\n",
       "      <td>2545.059961</td>\n",
       "      <td>...</td>\n",
       "      <td>13015.134801</td>\n",
       "      <td>4619.180929</td>\n",
       "      <td>14555.890777</td>\n",
       "      <td>36404.647443</td>\n",
       "      <td>11061.406831</td>\n",
       "      <td>18811.834712</td>\n",
       "      <td>10051.614846</td>\n",
       "      <td>1072.560984</td>\n",
       "      <td>6524.888900</td>\n",
       "      <td>0027219_session_3_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>57</th>\n",
       "      <td>1.457188e+07</td>\n",
       "      <td>252403.406140</td>\n",
       "      <td>3615.219945</td>\n",
       "      <td>222.263997</td>\n",
       "      <td>17210.367737</td>\n",
       "      <td>59259.766094</td>\n",
       "      <td>10074.252846</td>\n",
       "      <td>3793.579942</td>\n",
       "      <td>5505.149916</td>\n",
       "      <td>2284.379965</td>\n",
       "      <td>...</td>\n",
       "      <td>12466.677809</td>\n",
       "      <td>2892.518956</td>\n",
       "      <td>12917.036802</td>\n",
       "      <td>29611.532547</td>\n",
       "      <td>12906.746803</td>\n",
       "      <td>18788.167713</td>\n",
       "      <td>11522.055824</td>\n",
       "      <td>1199.127982</td>\n",
       "      <td>7147.776891</td>\n",
       "      <td>0027203_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58</th>\n",
       "      <td>1.467214e+07</td>\n",
       "      <td>226726.769533</td>\n",
       "      <td>5714.036913</td>\n",
       "      <td>252.104996</td>\n",
       "      <td>13717.598790</td>\n",
       "      <td>58820.726101</td>\n",
       "      <td>9567.298854</td>\n",
       "      <td>3504.430946</td>\n",
       "      <td>5559.686915</td>\n",
       "      <td>2362.583964</td>\n",
       "      <td>...</td>\n",
       "      <td>10037.208847</td>\n",
       "      <td>2927.504955</td>\n",
       "      <td>13871.605788</td>\n",
       "      <td>28252.909568</td>\n",
       "      <td>9853.360849</td>\n",
       "      <td>17767.056728</td>\n",
       "      <td>10526.326839</td>\n",
       "      <td>1063.985984</td>\n",
       "      <td>6717.311897</td>\n",
       "      <td>0027221_session_2_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>59</th>\n",
       "      <td>1.480179e+07</td>\n",
       "      <td>186131.005154</td>\n",
       "      <td>3439.603947</td>\n",
       "      <td>359.120995</td>\n",
       "      <td>14080.492785</td>\n",
       "      <td>56092.161142</td>\n",
       "      <td>8489.249870</td>\n",
       "      <td>3290.741950</td>\n",
       "      <td>5277.740919</td>\n",
       "      <td>2054.569969</td>\n",
       "      <td>...</td>\n",
       "      <td>10210.423844</td>\n",
       "      <td>2739.197958</td>\n",
       "      <td>12487.257809</td>\n",
       "      <td>26426.434596</td>\n",
       "      <td>11799.885820</td>\n",
       "      <td>16278.436751</td>\n",
       "      <td>8942.695863</td>\n",
       "      <td>994.013985</td>\n",
       "      <td>7051.393892</td>\n",
       "      <td>0027215_session_1_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>60</th>\n",
       "      <td>1.464142e+07</td>\n",
       "      <td>227580.496520</td>\n",
       "      <td>4075.525938</td>\n",
       "      <td>480.542993</td>\n",
       "      <td>13128.667799</td>\n",
       "      <td>52951.310190</td>\n",
       "      <td>9535.399854</td>\n",
       "      <td>3549.706946</td>\n",
       "      <td>5714.722913</td>\n",
       "      <td>2220.238966</td>\n",
       "      <td>...</td>\n",
       "      <td>11948.747817</td>\n",
       "      <td>3730.467943</td>\n",
       "      <td>14298.983781</td>\n",
       "      <td>32013.904510</td>\n",
       "      <td>12600.447807</td>\n",
       "      <td>18383.084719</td>\n",
       "      <td>12929.041802</td>\n",
       "      <td>1284.191980</td>\n",
       "      <td>6556.787900</td>\n",
       "      <td>0027212_session_3_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>61</th>\n",
       "      <td>1.464351e+07</td>\n",
       "      <td>224822.433562</td>\n",
       "      <td>6010.388908</td>\n",
       "      <td>433.208993</td>\n",
       "      <td>15280.649766</td>\n",
       "      <td>60443.802076</td>\n",
       "      <td>8790.060866</td>\n",
       "      <td>3960.963939</td>\n",
       "      <td>5385.099918</td>\n",
       "      <td>2275.461965</td>\n",
       "      <td>...</td>\n",
       "      <td>11647.593822</td>\n",
       "      <td>2829.063957</td>\n",
       "      <td>13280.273797</td>\n",
       "      <td>27893.445573</td>\n",
       "      <td>11560.471823</td>\n",
       "      <td>17794.839728</td>\n",
       "      <td>11296.361827</td>\n",
       "      <td>993.670985</td>\n",
       "      <td>6549.584900</td>\n",
       "      <td>0027220_session_1_anat_2_Tag_pr100_sr100_ppf10...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>62 rows × 97 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               0              2             4           5             7  \\\n",
       "0   1.461628e+07  229382.961492   6657.972898  376.270994  15693.964760   \n",
       "1   1.478108e+07  188578.310116   5184.787921  327.564995  11849.277819   \n",
       "2   1.478631e+07  187827.483128   5450.955917  373.183994  11846.533819   \n",
       "3   1.463785e+07  226204.723541  11956.979817  221.920997  13980.679786   \n",
       "4   1.450475e+07  247010.074223  11198.949829  487.402993  14238.958782   \n",
       "..           ...            ...           ...         ...           ...   \n",
       "57  1.457188e+07  252403.406140   3615.219945  222.263997  17210.367737   \n",
       "58  1.467214e+07  226726.769533   5714.036913  252.104996  13717.598790   \n",
       "59  1.480179e+07  186131.005154   3439.603947  359.120995  14080.492785   \n",
       "60  1.464142e+07  227580.496520   4075.525938  480.542993  13128.667799   \n",
       "61  1.464351e+07  224822.433562   6010.388908  433.208993  15280.649766   \n",
       "\n",
       "               8            10           11           12           13  ...  \\\n",
       "0   61671.742057   8952.985863  3790.149942  6516.313900  2491.551962  ...   \n",
       "1   45861.500299   8209.018874  3629.282945  4737.858928  2017.525969  ...   \n",
       "2   45955.825297   8193.240875  3577.832945  4704.244928  2003.119969  ...   \n",
       "3   58942.491099   8267.328874  4102.279937  5442.380917  2366.699964  ...   \n",
       "4   59908.036084   9053.484862  4083.414938  6573.251899  2545.059961  ...   \n",
       "..           ...           ...          ...          ...          ...  ...   \n",
       "57  59259.766094  10074.252846  3793.579942  5505.149916  2284.379965  ...   \n",
       "58  58820.726101   9567.298854  3504.430946  5559.686915  2362.583964  ...   \n",
       "59  56092.161142   8489.249870  3290.741950  5277.740919  2054.569969  ...   \n",
       "60  52951.310190   9535.399854  3549.706946  5714.722913  2220.238966  ...   \n",
       "61  60443.802076   8790.060866  3960.963939  5385.099918  2275.461965  ...   \n",
       "\n",
       "            2025         2026          2027          2028          2029  \\\n",
       "0   10991.434832  2993.017954  11598.201823  32107.886509  10237.520843   \n",
       "1   12179.929814  3022.858954  12187.818814  26460.734595  11824.581819   \n",
       "2   12036.555816  2969.350955  12041.700816  26196.967599  11787.194820   \n",
       "3   10938.955833  2500.126962  11846.876819  29088.114555  12553.113808   \n",
       "4   13015.134801  4619.180929  14555.890777  36404.647443  11061.406831   \n",
       "..           ...          ...           ...           ...           ...   \n",
       "57  12466.677809  2892.518956  12917.036802  29611.532547  12906.746803   \n",
       "58  10037.208847  2927.504955  13871.605788  28252.909568   9853.360849   \n",
       "59  10210.423844  2739.197958  12487.257809  26426.434596  11799.885820   \n",
       "60  11948.747817  3730.467943  14298.983781  32013.904510  12600.447807   \n",
       "61  11647.593822  2829.063957  13280.273797  27893.445573  11560.471823   \n",
       "\n",
       "            2030          2031         2034         2035  \\\n",
       "0   18619.068715   9259.284858  1126.754983  7135.428891   \n",
       "1   18073.698724  10989.033832  1434.768978  6411.698902   \n",
       "2   18027.393724  10760.938835  1437.169978  6377.398902   \n",
       "3   16824.492743  11385.541826  1070.845984  7051.050892   \n",
       "4   18811.834712  10051.614846  1072.560984  6524.888900   \n",
       "..           ...           ...          ...          ...   \n",
       "57  18788.167713  11522.055824  1199.127982  7147.776891   \n",
       "58  17767.056728  10526.326839  1063.985984  6717.311897   \n",
       "59  16278.436751   8942.695863   994.013985  7051.393892   \n",
       "60  18383.084719  12929.041802  1284.191980  6556.787900   \n",
       "61  17794.839728  11296.361827   993.670985  6549.584900   \n",
       "\n",
       "                                              subject  \n",
       "0   0027222_session_2_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "1   0027214_session_2_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "2   0027214_session_1_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "3                                   0027207_session_2  \n",
       "4   0027219_session_3_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "..                                                ...  \n",
       "57                                  0027203_session_1  \n",
       "58  0027221_session_2_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "59  0027215_session_1_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "60  0027212_session_3_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "61  0027220_session_1_anat_2_Tag_pr100_sr100_ppf10...  \n",
       "\n",
       "[62 rows x 97 columns]"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "volume_df3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "1e6d784c-97a5-4531-9d02-92d3a771adae",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir4 = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/SWU_3'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "d2475c69-44ae-4e75-af52-80f8ac72e1e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_data4 = []#고치기\n",
    "\n",
    "for subject_dir in os.listdir(base_dir4):# 고치기\n",
    "    full_subject_dir = os.path.join(base_dir4, subject_dir)#고치기\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data4.append(vol_data) #고치기 \n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df4 = pd.DataFrame(volume_data4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "e3f3b814-2e74-46f8-8388-7769d95abdee",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df4['subject'] = volume_df4['subject'].str.replace('_anat_1_Tag_pr100_sr100_ppf100_spf100_ipf100_sipf143_FS222', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "e9a50d5c-a3eb-46d6-a1d7-4ff1a2688fc6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>0</th>\n",
       "      <th>2</th>\n",
       "      <th>4</th>\n",
       "      <th>5</th>\n",
       "      <th>7</th>\n",
       "      <th>8</th>\n",
       "      <th>10</th>\n",
       "      <th>11</th>\n",
       "      <th>12</th>\n",
       "      <th>13</th>\n",
       "      <th>...</th>\n",
       "      <th>2025</th>\n",
       "      <th>2026</th>\n",
       "      <th>2027</th>\n",
       "      <th>2028</th>\n",
       "      <th>2029</th>\n",
       "      <th>2030</th>\n",
       "      <th>2031</th>\n",
       "      <th>2034</th>\n",
       "      <th>2035</th>\n",
       "      <th>subject</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.467377e+07</td>\n",
       "      <td>220073.941635</td>\n",
       "      <td>4224.044935</td>\n",
       "      <td>232.553996</td>\n",
       "      <td>12940.360802</td>\n",
       "      <td>56864.940130</td>\n",
       "      <td>8482.046870</td>\n",
       "      <td>4388.684933</td>\n",
       "      <td>6113.288907</td>\n",
       "      <td>2170.503967</td>\n",
       "      <td>...</td>\n",
       "      <td>12466.677809</td>\n",
       "      <td>2659.278959</td>\n",
       "      <td>14305.157781</td>\n",
       "      <td>26304.669598</td>\n",
       "      <td>13048.062800</td>\n",
       "      <td>18280.527720</td>\n",
       "      <td>11724.082821</td>\n",
       "      <td>1175.117982</td>\n",
       "      <td>6632.933899</td>\n",
       "      <td>0027162_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1.450608e+07</td>\n",
       "      <td>250557.723168</td>\n",
       "      <td>18296.991720</td>\n",
       "      <td>273.027996</td>\n",
       "      <td>16186.512752</td>\n",
       "      <td>68344.120955</td>\n",
       "      <td>9474.688855</td>\n",
       "      <td>4543.720931</td>\n",
       "      <td>5538.763915</td>\n",
       "      <td>2593.422960</td>\n",
       "      <td>...</td>\n",
       "      <td>13731.661790</td>\n",
       "      <td>2409.917963</td>\n",
       "      <td>13172.228799</td>\n",
       "      <td>28660.050562</td>\n",
       "      <td>13117.005799</td>\n",
       "      <td>18129.950723</td>\n",
       "      <td>10987.661832</td>\n",
       "      <td>1022.139984</td>\n",
       "      <td>6655.571898</td>\n",
       "      <td>0027157_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1.440877e+07</td>\n",
       "      <td>257322.026065</td>\n",
       "      <td>32957.154496</td>\n",
       "      <td>1034.144984</td>\n",
       "      <td>15333.471766</td>\n",
       "      <td>65675.923996</td>\n",
       "      <td>9779.615850</td>\n",
       "      <td>3998.350939</td>\n",
       "      <td>6097.853907</td>\n",
       "      <td>2750.859958</td>\n",
       "      <td>...</td>\n",
       "      <td>14239.301782</td>\n",
       "      <td>3215.624951</td>\n",
       "      <td>17052.587739</td>\n",
       "      <td>34240.317476</td>\n",
       "      <td>17298.175735</td>\n",
       "      <td>20901.390680</td>\n",
       "      <td>12675.907806</td>\n",
       "      <td>1105.831983</td>\n",
       "      <td>7841.322880</td>\n",
       "      <td>0027171_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1.467377e+07</td>\n",
       "      <td>220073.941635</td>\n",
       "      <td>4224.044935</td>\n",
       "      <td>232.553996</td>\n",
       "      <td>12940.360802</td>\n",
       "      <td>56864.940130</td>\n",
       "      <td>8482.046870</td>\n",
       "      <td>4388.684933</td>\n",
       "      <td>6113.288907</td>\n",
       "      <td>2170.503967</td>\n",
       "      <td>...</td>\n",
       "      <td>12466.677809</td>\n",
       "      <td>2659.278959</td>\n",
       "      <td>14305.157781</td>\n",
       "      <td>26304.669598</td>\n",
       "      <td>13048.062800</td>\n",
       "      <td>18280.527720</td>\n",
       "      <td>11724.082821</td>\n",
       "      <td>1175.117982</td>\n",
       "      <td>6632.933899</td>\n",
       "      <td>0027162_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1.455123e+07</td>\n",
       "      <td>244751.419257</td>\n",
       "      <td>4602.373930</td>\n",
       "      <td>377.985994</td>\n",
       "      <td>14744.883775</td>\n",
       "      <td>53541.613181</td>\n",
       "      <td>9332.343857</td>\n",
       "      <td>3928.721940</td>\n",
       "      <td>6614.411899</td>\n",
       "      <td>2478.517962</td>\n",
       "      <td>...</td>\n",
       "      <td>13232.253798</td>\n",
       "      <td>3268.103950</td>\n",
       "      <td>15629.480761</td>\n",
       "      <td>35207.577462</td>\n",
       "      <td>11687.038821</td>\n",
       "      <td>19797.273697</td>\n",
       "      <td>10612.419838</td>\n",
       "      <td>1027.970984</td>\n",
       "      <td>7713.383882</td>\n",
       "      <td>0027160_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1.455527e+07</td>\n",
       "      <td>232350.597447</td>\n",
       "      <td>5173.811921</td>\n",
       "      <td>392.391994</td>\n",
       "      <td>14828.918773</td>\n",
       "      <td>61513.962059</td>\n",
       "      <td>8408.301871</td>\n",
       "      <td>4145.154937</td>\n",
       "      <td>6095.452907</td>\n",
       "      <td>2496.353962</td>\n",
       "      <td>...</td>\n",
       "      <td>12502.349809</td>\n",
       "      <td>3214.938951</td>\n",
       "      <td>13099.512800</td>\n",
       "      <td>36948.302435</td>\n",
       "      <td>12986.322801</td>\n",
       "      <td>19298.894705</td>\n",
       "      <td>10710.517836</td>\n",
       "      <td>1298.254980</td>\n",
       "      <td>7991.556878</td>\n",
       "      <td>0027174_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1.475830e+07</td>\n",
       "      <td>197109.405986</td>\n",
       "      <td>5083.259922</td>\n",
       "      <td>208.200997</td>\n",
       "      <td>12332.907811</td>\n",
       "      <td>50200.793232</td>\n",
       "      <td>8051.238877</td>\n",
       "      <td>3559.996946</td>\n",
       "      <td>4754.665927</td>\n",
       "      <td>1905.707971</td>\n",
       "      <td>...</td>\n",
       "      <td>11266.520828</td>\n",
       "      <td>3162.459952</td>\n",
       "      <td>11551.553823</td>\n",
       "      <td>29872.555543</td>\n",
       "      <td>12506.122809</td>\n",
       "      <td>16174.507753</td>\n",
       "      <td>10027.261847</td>\n",
       "      <td>918.553986</td>\n",
       "      <td>5639.948914</td>\n",
       "      <td>0027152_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1.471778e+07</td>\n",
       "      <td>203658.647886</td>\n",
       "      <td>3307.548949</td>\n",
       "      <td>106.672998</td>\n",
       "      <td>13736.120790</td>\n",
       "      <td>55786.205147</td>\n",
       "      <td>8364.397872</td>\n",
       "      <td>4097.820937</td>\n",
       "      <td>5368.978918</td>\n",
       "      <td>2204.117966</td>\n",
       "      <td>...</td>\n",
       "      <td>10568.858838</td>\n",
       "      <td>2869.194956</td>\n",
       "      <td>13458.290794</td>\n",
       "      <td>28394.225566</td>\n",
       "      <td>13856.170788</td>\n",
       "      <td>16527.111747</td>\n",
       "      <td>9923.675848</td>\n",
       "      <td>796.445988</td>\n",
       "      <td>6530.033900</td>\n",
       "      <td>0027156_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1.450307e+07</td>\n",
       "      <td>252678.149136</td>\n",
       "      <td>7729.504882</td>\n",
       "      <td>125.194998</td>\n",
       "      <td>15378.747765</td>\n",
       "      <td>58539.809105</td>\n",
       "      <td>10368.889841</td>\n",
       "      <td>3697.196943</td>\n",
       "      <td>5701.002913</td>\n",
       "      <td>2234.301966</td>\n",
       "      <td>...</td>\n",
       "      <td>13553.301793</td>\n",
       "      <td>3765.796942</td>\n",
       "      <td>15519.720763</td>\n",
       "      <td>30901.212527</td>\n",
       "      <td>13378.714795</td>\n",
       "      <td>17680.620730</td>\n",
       "      <td>13893.557788</td>\n",
       "      <td>1464.266978</td>\n",
       "      <td>7924.328879</td>\n",
       "      <td>0027165_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1.475830e+07</td>\n",
       "      <td>197109.405986</td>\n",
       "      <td>5083.259922</td>\n",
       "      <td>208.200997</td>\n",
       "      <td>12332.907811</td>\n",
       "      <td>50200.793232</td>\n",
       "      <td>8051.238877</td>\n",
       "      <td>3559.996946</td>\n",
       "      <td>4754.665927</td>\n",
       "      <td>1905.707971</td>\n",
       "      <td>...</td>\n",
       "      <td>11266.520828</td>\n",
       "      <td>3162.459952</td>\n",
       "      <td>11551.553823</td>\n",
       "      <td>29872.555543</td>\n",
       "      <td>12506.122809</td>\n",
       "      <td>16174.507753</td>\n",
       "      <td>10027.261847</td>\n",
       "      <td>918.553986</td>\n",
       "      <td>5639.948914</td>\n",
       "      <td>0027152_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1.463749e+07</td>\n",
       "      <td>226321.686539</td>\n",
       "      <td>6010.731908</td>\n",
       "      <td>437.667993</td>\n",
       "      <td>15592.436762</td>\n",
       "      <td>60998.090067</td>\n",
       "      <td>8758.847866</td>\n",
       "      <td>4018.244939</td>\n",
       "      <td>5320.272919</td>\n",
       "      <td>2268.944965</td>\n",
       "      <td>...</td>\n",
       "      <td>11508.678824</td>\n",
       "      <td>2830.092957</td>\n",
       "      <td>13729.946790</td>\n",
       "      <td>27965.475572</td>\n",
       "      <td>11862.654819</td>\n",
       "      <td>17809.588728</td>\n",
       "      <td>11237.022828</td>\n",
       "      <td>1061.241984</td>\n",
       "      <td>6577.367899</td>\n",
       "      <td>0027170_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1.464955e+07</td>\n",
       "      <td>222398.109599</td>\n",
       "      <td>9097.388861</td>\n",
       "      <td>449.329993</td>\n",
       "      <td>12150.774814</td>\n",
       "      <td>56418.354137</td>\n",
       "      <td>8350.334872</td>\n",
       "      <td>3964.393939</td>\n",
       "      <td>5721.582913</td>\n",
       "      <td>2461.710962</td>\n",
       "      <td>...</td>\n",
       "      <td>11277.839828</td>\n",
       "      <td>2837.981957</td>\n",
       "      <td>11833.842819</td>\n",
       "      <td>29293.571552</td>\n",
       "      <td>10849.089834</td>\n",
       "      <td>18897.241711</td>\n",
       "      <td>10135.306845</td>\n",
       "      <td>1332.554980</td>\n",
       "      <td>7065.799892</td>\n",
       "      <td>0027172_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1.461370e+07</td>\n",
       "      <td>227309.183524</td>\n",
       "      <td>8906.337864</td>\n",
       "      <td>366.323994</td>\n",
       "      <td>12935.215802</td>\n",
       "      <td>58254.776109</td>\n",
       "      <td>8538.984869</td>\n",
       "      <td>3980.171939</td>\n",
       "      <td>5797.042911</td>\n",
       "      <td>2134.831967</td>\n",
       "      <td>...</td>\n",
       "      <td>10976.342832</td>\n",
       "      <td>2359.839964</td>\n",
       "      <td>15468.270763</td>\n",
       "      <td>31005.141526</td>\n",
       "      <td>12795.271804</td>\n",
       "      <td>18710.306714</td>\n",
       "      <td>10925.578833</td>\n",
       "      <td>999.158985</td>\n",
       "      <td>6656.943898</td>\n",
       "      <td>0027154_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1.461427e+07</td>\n",
       "      <td>236111.249389</td>\n",
       "      <td>8886.786864</td>\n",
       "      <td>281.259996</td>\n",
       "      <td>12088.005815</td>\n",
       "      <td>50275.224231</td>\n",
       "      <td>8450.833871</td>\n",
       "      <td>3294.514950</td>\n",
       "      <td>5019.118923</td>\n",
       "      <td>1866.605971</td>\n",
       "      <td>...</td>\n",
       "      <td>14251.649782</td>\n",
       "      <td>2561.523961</td>\n",
       "      <td>14315.447781</td>\n",
       "      <td>31941.188512</td>\n",
       "      <td>16420.095749</td>\n",
       "      <td>17021.031740</td>\n",
       "      <td>13290.906797</td>\n",
       "      <td>968.974985</td>\n",
       "      <td>6554.386900</td>\n",
       "      <td>0027161_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1.467040e+07</td>\n",
       "      <td>218169.262664</td>\n",
       "      <td>5193.019921</td>\n",
       "      <td>349.516995</td>\n",
       "      <td>13860.286788</td>\n",
       "      <td>50188.788233</td>\n",
       "      <td>8788.345866</td>\n",
       "      <td>4307.393934</td>\n",
       "      <td>5729.471912</td>\n",
       "      <td>2189.711967</td>\n",
       "      <td>...</td>\n",
       "      <td>12776.749805</td>\n",
       "      <td>2751.545958</td>\n",
       "      <td>11710.705821</td>\n",
       "      <td>29988.146541</td>\n",
       "      <td>12340.796811</td>\n",
       "      <td>17141.081738</td>\n",
       "      <td>11077.184831</td>\n",
       "      <td>1003.960985</td>\n",
       "      <td>7470.196886</td>\n",
       "      <td>0027169_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1.463749e+07</td>\n",
       "      <td>226321.686539</td>\n",
       "      <td>6010.731908</td>\n",
       "      <td>437.667993</td>\n",
       "      <td>15592.436762</td>\n",
       "      <td>60998.090067</td>\n",
       "      <td>8758.847866</td>\n",
       "      <td>4018.244939</td>\n",
       "      <td>5320.272919</td>\n",
       "      <td>2268.944965</td>\n",
       "      <td>...</td>\n",
       "      <td>11508.678824</td>\n",
       "      <td>2830.092957</td>\n",
       "      <td>13729.946790</td>\n",
       "      <td>27965.475572</td>\n",
       "      <td>11862.654819</td>\n",
       "      <td>17809.588728</td>\n",
       "      <td>11237.022828</td>\n",
       "      <td>1061.241984</td>\n",
       "      <td>6577.367899</td>\n",
       "      <td>0027170_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1.440877e+07</td>\n",
       "      <td>257322.026065</td>\n",
       "      <td>32957.154496</td>\n",
       "      <td>1034.144984</td>\n",
       "      <td>15333.471766</td>\n",
       "      <td>65675.923996</td>\n",
       "      <td>9779.615850</td>\n",
       "      <td>3998.350939</td>\n",
       "      <td>6097.853907</td>\n",
       "      <td>2750.859958</td>\n",
       "      <td>...</td>\n",
       "      <td>14239.301782</td>\n",
       "      <td>3215.624951</td>\n",
       "      <td>17052.587739</td>\n",
       "      <td>34240.317476</td>\n",
       "      <td>17298.175735</td>\n",
       "      <td>20901.390680</td>\n",
       "      <td>12675.907806</td>\n",
       "      <td>1105.831983</td>\n",
       "      <td>7841.322880</td>\n",
       "      <td>0027171_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1.464955e+07</td>\n",
       "      <td>222398.109599</td>\n",
       "      <td>9097.388861</td>\n",
       "      <td>449.329993</td>\n",
       "      <td>12150.774814</td>\n",
       "      <td>56418.354137</td>\n",
       "      <td>8350.334872</td>\n",
       "      <td>3964.393939</td>\n",
       "      <td>5721.582913</td>\n",
       "      <td>2461.710962</td>\n",
       "      <td>...</td>\n",
       "      <td>11277.839828</td>\n",
       "      <td>2837.981957</td>\n",
       "      <td>11833.842819</td>\n",
       "      <td>29293.571552</td>\n",
       "      <td>10849.089834</td>\n",
       "      <td>18897.241711</td>\n",
       "      <td>10135.306845</td>\n",
       "      <td>1332.554980</td>\n",
       "      <td>7065.799892</td>\n",
       "      <td>0027172_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1.472202e+07</td>\n",
       "      <td>203536.882887</td>\n",
       "      <td>3336.360949</td>\n",
       "      <td>105.300998</td>\n",
       "      <td>13444.913794</td>\n",
       "      <td>56184.771141</td>\n",
       "      <td>8316.034873</td>\n",
       "      <td>4044.655938</td>\n",
       "      <td>5397.790917</td>\n",
       "      <td>2243.562966</td>\n",
       "      <td>...</td>\n",
       "      <td>10634.714837</td>\n",
       "      <td>2741.255958</td>\n",
       "      <td>13143.073799</td>\n",
       "      <td>27969.591572</td>\n",
       "      <td>13285.418797</td>\n",
       "      <td>16302.789751</td>\n",
       "      <td>9920.931848</td>\n",
       "      <td>797.131988</td>\n",
       "      <td>6510.482900</td>\n",
       "      <td>0027156_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1.467859e+07</td>\n",
       "      <td>226198.892541</td>\n",
       "      <td>6639.793898</td>\n",
       "      <td>248.674996</td>\n",
       "      <td>16155.985753</td>\n",
       "      <td>55404.789153</td>\n",
       "      <td>9490.123855</td>\n",
       "      <td>4350.268933</td>\n",
       "      <td>5667.731913</td>\n",
       "      <td>2494.638962</td>\n",
       "      <td>...</td>\n",
       "      <td>11689.096821</td>\n",
       "      <td>2406.144963</td>\n",
       "      <td>13205.499798</td>\n",
       "      <td>27131.299585</td>\n",
       "      <td>12403.565810</td>\n",
       "      <td>15869.923757</td>\n",
       "      <td>9888.003849</td>\n",
       "      <td>936.389986</td>\n",
       "      <td>6223.391905</td>\n",
       "      <td>0027164_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1.476228e+07</td>\n",
       "      <td>189520.531102</td>\n",
       "      <td>6747.838897</td>\n",
       "      <td>205.456997</td>\n",
       "      <td>14255.765782</td>\n",
       "      <td>57586.612119</td>\n",
       "      <td>8469.012870</td>\n",
       "      <td>3581.262945</td>\n",
       "      <td>5017.746923</td>\n",
       "      <td>2134.145967</td>\n",
       "      <td>...</td>\n",
       "      <td>9438.673856</td>\n",
       "      <td>2081.323968</td>\n",
       "      <td>10726.638836</td>\n",
       "      <td>26388.018596</td>\n",
       "      <td>10445.035840</td>\n",
       "      <td>18554.584716</td>\n",
       "      <td>9275.405858</td>\n",
       "      <td>909.978986</td>\n",
       "      <td>6107.114907</td>\n",
       "      <td>0027158_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1.450307e+07</td>\n",
       "      <td>252678.149136</td>\n",
       "      <td>7729.504882</td>\n",
       "      <td>125.194998</td>\n",
       "      <td>15378.747765</td>\n",
       "      <td>58539.809105</td>\n",
       "      <td>10368.889841</td>\n",
       "      <td>3697.196943</td>\n",
       "      <td>5701.002913</td>\n",
       "      <td>2234.301966</td>\n",
       "      <td>...</td>\n",
       "      <td>13553.301793</td>\n",
       "      <td>3765.796942</td>\n",
       "      <td>15519.720763</td>\n",
       "      <td>30901.212527</td>\n",
       "      <td>13378.714795</td>\n",
       "      <td>17680.620730</td>\n",
       "      <td>13893.557788</td>\n",
       "      <td>1464.266978</td>\n",
       "      <td>7924.328879</td>\n",
       "      <td>0027165_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1.461427e+07</td>\n",
       "      <td>236111.249389</td>\n",
       "      <td>8886.786864</td>\n",
       "      <td>281.259996</td>\n",
       "      <td>12088.005815</td>\n",
       "      <td>50275.224231</td>\n",
       "      <td>8450.833871</td>\n",
       "      <td>3294.514950</td>\n",
       "      <td>5019.118923</td>\n",
       "      <td>1866.605971</td>\n",
       "      <td>...</td>\n",
       "      <td>14251.649782</td>\n",
       "      <td>2561.523961</td>\n",
       "      <td>14315.447781</td>\n",
       "      <td>31941.188512</td>\n",
       "      <td>16420.095749</td>\n",
       "      <td>17021.031740</td>\n",
       "      <td>13290.906797</td>\n",
       "      <td>968.974985</td>\n",
       "      <td>6554.386900</td>\n",
       "      <td>0027161_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1.450401e+07</td>\n",
       "      <td>251030.034161</td>\n",
       "      <td>18076.442724</td>\n",
       "      <td>265.138996</td>\n",
       "      <td>16175.193753</td>\n",
       "      <td>68440.503953</td>\n",
       "      <td>9564.897854</td>\n",
       "      <td>4594.484930</td>\n",
       "      <td>5500.347916</td>\n",
       "      <td>2615.717960</td>\n",
       "      <td>...</td>\n",
       "      <td>13759.101790</td>\n",
       "      <td>2383.849964</td>\n",
       "      <td>12756.855805</td>\n",
       "      <td>28863.449559</td>\n",
       "      <td>13168.112799</td>\n",
       "      <td>18381.712719</td>\n",
       "      <td>10943.071833</td>\n",
       "      <td>1034.830984</td>\n",
       "      <td>6688.156898</td>\n",
       "      <td>0027157_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1.476141e+07</td>\n",
       "      <td>189433.066103</td>\n",
       "      <td>6668.262898</td>\n",
       "      <td>194.823997</td>\n",
       "      <td>13940.548787</td>\n",
       "      <td>57878.505115</td>\n",
       "      <td>8607.241868</td>\n",
       "      <td>3592.238945</td>\n",
       "      <td>5015.688923</td>\n",
       "      <td>2120.768968</td>\n",
       "      <td>...</td>\n",
       "      <td>9529.225854</td>\n",
       "      <td>2064.859968</td>\n",
       "      <td>10574.346838</td>\n",
       "      <td>26374.984597</td>\n",
       "      <td>10333.560842</td>\n",
       "      <td>18322.030720</td>\n",
       "      <td>9075.779861</td>\n",
       "      <td>908.606986</td>\n",
       "      <td>6021.021908</td>\n",
       "      <td>0027158_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1.467859e+07</td>\n",
       "      <td>226198.892541</td>\n",
       "      <td>6639.793898</td>\n",
       "      <td>248.674996</td>\n",
       "      <td>16155.985753</td>\n",
       "      <td>55404.789153</td>\n",
       "      <td>9490.123855</td>\n",
       "      <td>4350.268933</td>\n",
       "      <td>5667.731913</td>\n",
       "      <td>2494.638962</td>\n",
       "      <td>...</td>\n",
       "      <td>11689.096821</td>\n",
       "      <td>2406.144963</td>\n",
       "      <td>13205.499798</td>\n",
       "      <td>27131.299585</td>\n",
       "      <td>12403.565810</td>\n",
       "      <td>15869.923757</td>\n",
       "      <td>9888.003849</td>\n",
       "      <td>936.389986</td>\n",
       "      <td>6223.391905</td>\n",
       "      <td>0027164_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1.460265e+07</td>\n",
       "      <td>234266.595418</td>\n",
       "      <td>5340.509918</td>\n",
       "      <td>219.519997</td>\n",
       "      <td>15237.431767</td>\n",
       "      <td>62891.450038</td>\n",
       "      <td>9408.146856</td>\n",
       "      <td>3671.814944</td>\n",
       "      <td>5941.445909</td>\n",
       "      <td>2528.938961</td>\n",
       "      <td>...</td>\n",
       "      <td>12718.782806</td>\n",
       "      <td>3629.282945</td>\n",
       "      <td>13133.126799</td>\n",
       "      <td>29452.037550</td>\n",
       "      <td>12325.361812</td>\n",
       "      <td>18677.378714</td>\n",
       "      <td>12082.860815</td>\n",
       "      <td>923.355986</td>\n",
       "      <td>7344.658888</td>\n",
       "      <td>0027173_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1.460265e+07</td>\n",
       "      <td>234266.595418</td>\n",
       "      <td>5340.509918</td>\n",
       "      <td>219.519997</td>\n",
       "      <td>15237.431767</td>\n",
       "      <td>62891.450038</td>\n",
       "      <td>9408.146856</td>\n",
       "      <td>3671.814944</td>\n",
       "      <td>5941.445909</td>\n",
       "      <td>2528.938961</td>\n",
       "      <td>...</td>\n",
       "      <td>12718.782806</td>\n",
       "      <td>3629.282945</td>\n",
       "      <td>13133.126799</td>\n",
       "      <td>29452.037550</td>\n",
       "      <td>12325.361812</td>\n",
       "      <td>18677.378714</td>\n",
       "      <td>12082.860815</td>\n",
       "      <td>923.355986</td>\n",
       "      <td>7344.658888</td>\n",
       "      <td>0027173_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1.455527e+07</td>\n",
       "      <td>232350.597447</td>\n",
       "      <td>5173.811921</td>\n",
       "      <td>392.391994</td>\n",
       "      <td>14828.918773</td>\n",
       "      <td>61513.962059</td>\n",
       "      <td>8408.301871</td>\n",
       "      <td>4145.154937</td>\n",
       "      <td>6095.452907</td>\n",
       "      <td>2496.353962</td>\n",
       "      <td>...</td>\n",
       "      <td>12502.349809</td>\n",
       "      <td>3214.938951</td>\n",
       "      <td>13099.512800</td>\n",
       "      <td>36948.302435</td>\n",
       "      <td>12986.322801</td>\n",
       "      <td>19298.894705</td>\n",
       "      <td>10710.517836</td>\n",
       "      <td>1298.254980</td>\n",
       "      <td>7991.556878</td>\n",
       "      <td>0027174_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1.467040e+07</td>\n",
       "      <td>218169.262664</td>\n",
       "      <td>5193.019921</td>\n",
       "      <td>349.516995</td>\n",
       "      <td>13860.286788</td>\n",
       "      <td>50188.788233</td>\n",
       "      <td>8788.345866</td>\n",
       "      <td>4307.393934</td>\n",
       "      <td>5729.471912</td>\n",
       "      <td>2189.711967</td>\n",
       "      <td>...</td>\n",
       "      <td>12776.749805</td>\n",
       "      <td>2751.545958</td>\n",
       "      <td>11710.705821</td>\n",
       "      <td>29988.146541</td>\n",
       "      <td>12340.796811</td>\n",
       "      <td>17141.081738</td>\n",
       "      <td>11077.184831</td>\n",
       "      <td>1003.960985</td>\n",
       "      <td>7470.196886</td>\n",
       "      <td>0027169_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>1.462820e+07</td>\n",
       "      <td>232595.842443</td>\n",
       "      <td>3654.664944</td>\n",
       "      <td>253.819996</td>\n",
       "      <td>17009.369740</td>\n",
       "      <td>62227.745048</td>\n",
       "      <td>8909.424864</td>\n",
       "      <td>3490.024947</td>\n",
       "      <td>5293.861919</td>\n",
       "      <td>2185.938967</td>\n",
       "      <td>...</td>\n",
       "      <td>11385.541826</td>\n",
       "      <td>2949.113955</td>\n",
       "      <td>12288.660812</td>\n",
       "      <td>32717.397500</td>\n",
       "      <td>12966.428802</td>\n",
       "      <td>18038.369724</td>\n",
       "      <td>10701.599836</td>\n",
       "      <td>886.311986</td>\n",
       "      <td>6441.196902</td>\n",
       "      <td>0027166_session_2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>1.461305e+07</td>\n",
       "      <td>227582.897520</td>\n",
       "      <td>8915.255864</td>\n",
       "      <td>376.270994</td>\n",
       "      <td>13030.226801</td>\n",
       "      <td>58405.010107</td>\n",
       "      <td>8574.999869</td>\n",
       "      <td>3992.176939</td>\n",
       "      <td>5735.302912</td>\n",
       "      <td>2116.995968</td>\n",
       "      <td>...</td>\n",
       "      <td>11157.446829</td>\n",
       "      <td>2337.544964</td>\n",
       "      <td>15492.623763</td>\n",
       "      <td>30752.007530</td>\n",
       "      <td>12762.000805</td>\n",
       "      <td>18947.319710</td>\n",
       "      <td>11076.498831</td>\n",
       "      <td>1061.927984</td>\n",
       "      <td>6639.793898</td>\n",
       "      <td>0027154_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>1.462820e+07</td>\n",
       "      <td>232595.842443</td>\n",
       "      <td>3654.664944</td>\n",
       "      <td>253.819996</td>\n",
       "      <td>17009.369740</td>\n",
       "      <td>62227.745048</td>\n",
       "      <td>8909.424864</td>\n",
       "      <td>3490.024947</td>\n",
       "      <td>5293.861919</td>\n",
       "      <td>2185.938967</td>\n",
       "      <td>...</td>\n",
       "      <td>11385.541826</td>\n",
       "      <td>2949.113955</td>\n",
       "      <td>12288.660812</td>\n",
       "      <td>32717.397500</td>\n",
       "      <td>12966.428802</td>\n",
       "      <td>18038.369724</td>\n",
       "      <td>10701.599836</td>\n",
       "      <td>886.311986</td>\n",
       "      <td>6441.196902</td>\n",
       "      <td>0027166_session_1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>1.455285e+07</td>\n",
       "      <td>244231.431265</td>\n",
       "      <td>4547.150930</td>\n",
       "      <td>394.449994</td>\n",
       "      <td>14731.163775</td>\n",
       "      <td>53226.053186</td>\n",
       "      <td>9351.208857</td>\n",
       "      <td>3954.103940</td>\n",
       "      <td>6653.170898</td>\n",
       "      <td>2457.251962</td>\n",
       "      <td>...</td>\n",
       "      <td>13301.882797</td>\n",
       "      <td>3242.721950</td>\n",
       "      <td>15366.056765</td>\n",
       "      <td>35223.698461</td>\n",
       "      <td>11574.191823</td>\n",
       "      <td>19724.900698</td>\n",
       "      <td>10725.609836</td>\n",
       "      <td>1007.390985</td>\n",
       "      <td>7671.880883</td>\n",
       "      <td>0027160_session_1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>34 rows × 97 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               0              2             4            5             7  \\\n",
       "0   1.467377e+07  220073.941635   4224.044935   232.553996  12940.360802   \n",
       "1   1.450608e+07  250557.723168  18296.991720   273.027996  16186.512752   \n",
       "2   1.440877e+07  257322.026065  32957.154496  1034.144984  15333.471766   \n",
       "3   1.467377e+07  220073.941635   4224.044935   232.553996  12940.360802   \n",
       "4   1.455123e+07  244751.419257   4602.373930   377.985994  14744.883775   \n",
       "5   1.455527e+07  232350.597447   5173.811921   392.391994  14828.918773   \n",
       "6   1.475830e+07  197109.405986   5083.259922   208.200997  12332.907811   \n",
       "7   1.471778e+07  203658.647886   3307.548949   106.672998  13736.120790   \n",
       "8   1.450307e+07  252678.149136   7729.504882   125.194998  15378.747765   \n",
       "9   1.475830e+07  197109.405986   5083.259922   208.200997  12332.907811   \n",
       "10  1.463749e+07  226321.686539   6010.731908   437.667993  15592.436762   \n",
       "11  1.464955e+07  222398.109599   9097.388861   449.329993  12150.774814   \n",
       "12  1.461370e+07  227309.183524   8906.337864   366.323994  12935.215802   \n",
       "13  1.461427e+07  236111.249389   8886.786864   281.259996  12088.005815   \n",
       "14  1.467040e+07  218169.262664   5193.019921   349.516995  13860.286788   \n",
       "15  1.463749e+07  226321.686539   6010.731908   437.667993  15592.436762   \n",
       "16  1.440877e+07  257322.026065  32957.154496  1034.144984  15333.471766   \n",
       "17  1.464955e+07  222398.109599   9097.388861   449.329993  12150.774814   \n",
       "18  1.472202e+07  203536.882887   3336.360949   105.300998  13444.913794   \n",
       "19  1.467859e+07  226198.892541   6639.793898   248.674996  16155.985753   \n",
       "20  1.476228e+07  189520.531102   6747.838897   205.456997  14255.765782   \n",
       "21  1.450307e+07  252678.149136   7729.504882   125.194998  15378.747765   \n",
       "22  1.461427e+07  236111.249389   8886.786864   281.259996  12088.005815   \n",
       "23  1.450401e+07  251030.034161  18076.442724   265.138996  16175.193753   \n",
       "24  1.476141e+07  189433.066103   6668.262898   194.823997  13940.548787   \n",
       "25  1.467859e+07  226198.892541   6639.793898   248.674996  16155.985753   \n",
       "26  1.460265e+07  234266.595418   5340.509918   219.519997  15237.431767   \n",
       "27  1.460265e+07  234266.595418   5340.509918   219.519997  15237.431767   \n",
       "28  1.455527e+07  232350.597447   5173.811921   392.391994  14828.918773   \n",
       "29  1.467040e+07  218169.262664   5193.019921   349.516995  13860.286788   \n",
       "30  1.462820e+07  232595.842443   3654.664944   253.819996  17009.369740   \n",
       "31  1.461305e+07  227582.897520   8915.255864   376.270994  13030.226801   \n",
       "32  1.462820e+07  232595.842443   3654.664944   253.819996  17009.369740   \n",
       "33  1.455285e+07  244231.431265   4547.150930   394.449994  14731.163775   \n",
       "\n",
       "               8            10           11           12           13  ...  \\\n",
       "0   56864.940130   8482.046870  4388.684933  6113.288907  2170.503967  ...   \n",
       "1   68344.120955   9474.688855  4543.720931  5538.763915  2593.422960  ...   \n",
       "2   65675.923996   9779.615850  3998.350939  6097.853907  2750.859958  ...   \n",
       "3   56864.940130   8482.046870  4388.684933  6113.288907  2170.503967  ...   \n",
       "4   53541.613181   9332.343857  3928.721940  6614.411899  2478.517962  ...   \n",
       "5   61513.962059   8408.301871  4145.154937  6095.452907  2496.353962  ...   \n",
       "6   50200.793232   8051.238877  3559.996946  4754.665927  1905.707971  ...   \n",
       "7   55786.205147   8364.397872  4097.820937  5368.978918  2204.117966  ...   \n",
       "8   58539.809105  10368.889841  3697.196943  5701.002913  2234.301966  ...   \n",
       "9   50200.793232   8051.238877  3559.996946  4754.665927  1905.707971  ...   \n",
       "10  60998.090067   8758.847866  4018.244939  5320.272919  2268.944965  ...   \n",
       "11  56418.354137   8350.334872  3964.393939  5721.582913  2461.710962  ...   \n",
       "12  58254.776109   8538.984869  3980.171939  5797.042911  2134.831967  ...   \n",
       "13  50275.224231   8450.833871  3294.514950  5019.118923  1866.605971  ...   \n",
       "14  50188.788233   8788.345866  4307.393934  5729.471912  2189.711967  ...   \n",
       "15  60998.090067   8758.847866  4018.244939  5320.272919  2268.944965  ...   \n",
       "16  65675.923996   9779.615850  3998.350939  6097.853907  2750.859958  ...   \n",
       "17  56418.354137   8350.334872  3964.393939  5721.582913  2461.710962  ...   \n",
       "18  56184.771141   8316.034873  4044.655938  5397.790917  2243.562966  ...   \n",
       "19  55404.789153   9490.123855  4350.268933  5667.731913  2494.638962  ...   \n",
       "20  57586.612119   8469.012870  3581.262945  5017.746923  2134.145967  ...   \n",
       "21  58539.809105  10368.889841  3697.196943  5701.002913  2234.301966  ...   \n",
       "22  50275.224231   8450.833871  3294.514950  5019.118923  1866.605971  ...   \n",
       "23  68440.503953   9564.897854  4594.484930  5500.347916  2615.717960  ...   \n",
       "24  57878.505115   8607.241868  3592.238945  5015.688923  2120.768968  ...   \n",
       "25  55404.789153   9490.123855  4350.268933  5667.731913  2494.638962  ...   \n",
       "26  62891.450038   9408.146856  3671.814944  5941.445909  2528.938961  ...   \n",
       "27  62891.450038   9408.146856  3671.814944  5941.445909  2528.938961  ...   \n",
       "28  61513.962059   8408.301871  4145.154937  6095.452907  2496.353962  ...   \n",
       "29  50188.788233   8788.345866  4307.393934  5729.471912  2189.711967  ...   \n",
       "30  62227.745048   8909.424864  3490.024947  5293.861919  2185.938967  ...   \n",
       "31  58405.010107   8574.999869  3992.176939  5735.302912  2116.995968  ...   \n",
       "32  62227.745048   8909.424864  3490.024947  5293.861919  2185.938967  ...   \n",
       "33  53226.053186   9351.208857  3954.103940  6653.170898  2457.251962  ...   \n",
       "\n",
       "            2025         2026          2027          2028          2029  \\\n",
       "0   12466.677809  2659.278959  14305.157781  26304.669598  13048.062800   \n",
       "1   13731.661790  2409.917963  13172.228799  28660.050562  13117.005799   \n",
       "2   14239.301782  3215.624951  17052.587739  34240.317476  17298.175735   \n",
       "3   12466.677809  2659.278959  14305.157781  26304.669598  13048.062800   \n",
       "4   13232.253798  3268.103950  15629.480761  35207.577462  11687.038821   \n",
       "5   12502.349809  3214.938951  13099.512800  36948.302435  12986.322801   \n",
       "6   11266.520828  3162.459952  11551.553823  29872.555543  12506.122809   \n",
       "7   10568.858838  2869.194956  13458.290794  28394.225566  13856.170788   \n",
       "8   13553.301793  3765.796942  15519.720763  30901.212527  13378.714795   \n",
       "9   11266.520828  3162.459952  11551.553823  29872.555543  12506.122809   \n",
       "10  11508.678824  2830.092957  13729.946790  27965.475572  11862.654819   \n",
       "11  11277.839828  2837.981957  11833.842819  29293.571552  10849.089834   \n",
       "12  10976.342832  2359.839964  15468.270763  31005.141526  12795.271804   \n",
       "13  14251.649782  2561.523961  14315.447781  31941.188512  16420.095749   \n",
       "14  12776.749805  2751.545958  11710.705821  29988.146541  12340.796811   \n",
       "15  11508.678824  2830.092957  13729.946790  27965.475572  11862.654819   \n",
       "16  14239.301782  3215.624951  17052.587739  34240.317476  17298.175735   \n",
       "17  11277.839828  2837.981957  11833.842819  29293.571552  10849.089834   \n",
       "18  10634.714837  2741.255958  13143.073799  27969.591572  13285.418797   \n",
       "19  11689.096821  2406.144963  13205.499798  27131.299585  12403.565810   \n",
       "20   9438.673856  2081.323968  10726.638836  26388.018596  10445.035840   \n",
       "21  13553.301793  3765.796942  15519.720763  30901.212527  13378.714795   \n",
       "22  14251.649782  2561.523961  14315.447781  31941.188512  16420.095749   \n",
       "23  13759.101790  2383.849964  12756.855805  28863.449559  13168.112799   \n",
       "24   9529.225854  2064.859968  10574.346838  26374.984597  10333.560842   \n",
       "25  11689.096821  2406.144963  13205.499798  27131.299585  12403.565810   \n",
       "26  12718.782806  3629.282945  13133.126799  29452.037550  12325.361812   \n",
       "27  12718.782806  3629.282945  13133.126799  29452.037550  12325.361812   \n",
       "28  12502.349809  3214.938951  13099.512800  36948.302435  12986.322801   \n",
       "29  12776.749805  2751.545958  11710.705821  29988.146541  12340.796811   \n",
       "30  11385.541826  2949.113955  12288.660812  32717.397500  12966.428802   \n",
       "31  11157.446829  2337.544964  15492.623763  30752.007530  12762.000805   \n",
       "32  11385.541826  2949.113955  12288.660812  32717.397500  12966.428802   \n",
       "33  13301.882797  3242.721950  15366.056765  35223.698461  11574.191823   \n",
       "\n",
       "            2030          2031         2034         2035            subject  \n",
       "0   18280.527720  11724.082821  1175.117982  6632.933899  0027162_session_1  \n",
       "1   18129.950723  10987.661832  1022.139984  6655.571898  0027157_session_1  \n",
       "2   20901.390680  12675.907806  1105.831983  7841.322880  0027171_session_1  \n",
       "3   18280.527720  11724.082821  1175.117982  6632.933899  0027162_session_2  \n",
       "4   19797.273697  10612.419838  1027.970984  7713.383882  0027160_session_2  \n",
       "5   19298.894705  10710.517836  1298.254980  7991.556878  0027174_session_1  \n",
       "6   16174.507753  10027.261847   918.553986  5639.948914  0027152_session_1  \n",
       "7   16527.111747   9923.675848   796.445988  6530.033900  0027156_session_2  \n",
       "8   17680.620730  13893.557788  1464.266978  7924.328879  0027165_session_1  \n",
       "9   16174.507753  10027.261847   918.553986  5639.948914  0027152_session_2  \n",
       "10  17809.588728  11237.022828  1061.241984  6577.367899  0027170_session_1  \n",
       "11  18897.241711  10135.306845  1332.554980  7065.799892  0027172_session_1  \n",
       "12  18710.306714  10925.578833   999.158985  6656.943898  0027154_session_2  \n",
       "13  17021.031740  13290.906797   968.974985  6554.386900  0027161_session_1  \n",
       "14  17141.081738  11077.184831  1003.960985  7470.196886  0027169_session_2  \n",
       "15  17809.588728  11237.022828  1061.241984  6577.367899  0027170_session_2  \n",
       "16  20901.390680  12675.907806  1105.831983  7841.322880  0027171_session_2  \n",
       "17  18897.241711  10135.306845  1332.554980  7065.799892  0027172_session_2  \n",
       "18  16302.789751   9920.931848   797.131988  6510.482900  0027156_session_1  \n",
       "19  15869.923757   9888.003849   936.389986  6223.391905  0027164_session_2  \n",
       "20  18554.584716   9275.405858   909.978986  6107.114907  0027158_session_1  \n",
       "21  17680.620730  13893.557788  1464.266978  7924.328879  0027165_session_2  \n",
       "22  17021.031740  13290.906797   968.974985  6554.386900  0027161_session_2  \n",
       "23  18381.712719  10943.071833  1034.830984  6688.156898  0027157_session_2  \n",
       "24  18322.030720   9075.779861   908.606986  6021.021908  0027158_session_2  \n",
       "25  15869.923757   9888.003849   936.389986  6223.391905  0027164_session_1  \n",
       "26  18677.378714  12082.860815   923.355986  7344.658888  0027173_session_1  \n",
       "27  18677.378714  12082.860815   923.355986  7344.658888  0027173_session_2  \n",
       "28  19298.894705  10710.517836  1298.254980  7991.556878  0027174_session_2  \n",
       "29  17141.081738  11077.184831  1003.960985  7470.196886  0027169_session_1  \n",
       "30  18038.369724  10701.599836   886.311986  6441.196902  0027166_session_2  \n",
       "31  18947.319710  11076.498831  1061.927984  6639.793898  0027154_session_1  \n",
       "32  18038.369724  10701.599836   886.311986  6441.196902  0027166_session_1  \n",
       "33  19724.900698  10725.609836  1007.390985  7671.880883  0027160_session_1  \n",
       "\n",
       "[34 rows x 97 columns]"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "volume_df4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "5b218a05-7068-4b19-be81-e277158d4355",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 경로만 지정!\n",
    "base_dir5 = '/home/limseoyoung/drwelly1/Team_Planning/Brain_Volumetry/oasis_vendor/NII/Simen/XHCUMS'\n",
    "\n",
    "\n",
    "def calculate_volume(nii_path):\n",
    "    img = nib.load(nii_path) \n",
    "    data = img.get_fdata()\n",
    "    header = img.header\n",
    "    voxel_volume = np.prod(header.get_zooms())\n",
    "    unique_elements, counts_elements = np.unique(data, return_counts=True)\n",
    "    volumes = counts_elements * voxel_volume\n",
    "    return dict(zip(unique_elements.astype(int), volumes))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "abbf644e-da0c-4552-a342-5aab468e868b",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_data5 = []#고치기\n",
    "\n",
    "for subject_dir in os.listdir(base_dir5):# 고치기\n",
    "    full_subject_dir = os.path.join(base_dir5, subject_dir)#고치기\n",
    "    if not os.path.isdir(full_subject_dir) or 'FS222' not in subject_dir:\n",
    "        continue\n",
    "    \n",
    "    double_subject_dir = os.path.join(full_subject_dir, subject_dir)\n",
    "    if not os.path.isdir(double_subject_dir):\n",
    "        continue\n",
    "    \n",
    "    mri_dir = os.path.join(double_subject_dir, 'mri')\n",
    "    nii_path = os.path.join(mri_dir, 'aparc.DKTatlas+aseg.deep.nii.gz')\n",
    "    \n",
    "    if os.path.isfile(nii_path):\n",
    "        try:\n",
    "            vol_data = calculate_volume(nii_path)\n",
    "            vol_data[\"subject\"] = subject_dir\n",
    "            volume_data5.append(vol_data) #고치기 \n",
    "        except OSError as e:\n",
    "            print(f\"Error processing file {nii_path}, skipped  Error: {e}\")\n",
    "    else:\n",
    "        print(f\"File not found, skipped: {nii_path}\")\n",
    "\n",
    "volume_df5 = pd.DataFrame(volume_data5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "3d53da62-e9e2-435a-bdcb-737872ac9d9b",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df5['subject'] = volume_df5['subject'].str.replace('_anat_1_Tag_pr100_sr88_ppf75_spf100_ipf100_sipf143a_FS222', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "131100c3-4c1c-4f53-b9a6-430724dc352c",
   "metadata": {},
   "outputs": [],
   "source": [
    "combined_df = pd.concat([volume_df, volume_df1,volume_df2,volume_df3,volume_df4,volume_df5], ignore_index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "bf0f8a9b-22c7-44fd-a499-d6192f6adbe4",
   "metadata": {},
   "outputs": [],
   "source": [
    "sesson1 = combined_df[combined_df['subject'].str.contains('session_1')]\n",
    "sesson2 = combined_df[combined_df['subject'].str.contains('session_2')]\n",
    "sesson3 = combined_df[combined_df['subject'].str.contains('session_3')]\n",
    "sesson4 = combined_df[combined_df['subject'].str.contains('session_4')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "ebdf45a5-cbae-44eb-b72b-3e46ec9a0d10",
   "metadata": {},
   "outputs": [],
   "source": [
    "lut_path = '/mnt/drwelly1/Team_Planning/Brain_Volumetry/Algorithms/freesurfer/FreeSurferColorLUT.txt'\n",
    "# labeling 불러오면됨"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "5ed5bdbb-80e8-4d62-9b8d-dca1134af5cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "lut_path = '/mnt/drwelly1/Team_Planning/Brain_Volumetry/Algorithms/freesurfer/FreeSurferColorLUT.txt'\n",
    "# labeling 불러오면됨"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "118ae8d8-11ac-4e7e-ab2a-7a127694e477",
   "metadata": {},
   "outputs": [],
   "source": [
    "def load_freesurfer_lut(lut_path):\n",
    "    lut = {}\n",
    "    with open(lut_path, 'r') as file:\n",
    "        for line in file:\n",
    "            if line.strip() and not line.startswith('#'):\n",
    "                parts = line.split()\n",
    "                if parts[0].isdigit():\n",
    "                    lut[int(parts[0])] = ' '.join(parts[1:])\n",
    "    return lut\n",
    "\n",
    "freesurfer_lut = load_freesurfer_lut(lut_path)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "f560f46c-fbe4-4ea0-9eb4-e0179f373693",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 모든 컬럼 이름을 변경\n",
    "new_columns = [freesurfer_lut.get(int(col), 'Unknown') if col != 'subject' else 'subject' for col in sesson1.columns]\n",
    "\n",
    "\n",
    "sesson1.columns = new_columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "2a63c54a-7697-4d08-9c0e-ed3f9a3110a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "def extract_number(subj):\n",
    "    parts = subj.split('_')  # '_'를 기준\n",
    "    if len(parts) > 1:\n",
    "        number_part = parts[1]  \n",
    "        # 숫자만 \n",
    "        numbers = ''.join(filter(str.isdigit, number_part))\n",
    "        return int(numbers) if numbers.isdigit() else None\n",
    "    return None"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "5d88a462-f876-45c2-af17-fa48c4a9f10c",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_3198212/2455975256.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  sesson1['sort_key'] = sesson1['subject'].apply(extract_number)\n"
     ]
    }
   ],
   "source": [
    "\n",
    "sesson1['sort_key'] = sesson1['subject'].apply(extract_number) \n",
    "volume_df_sorted1 = sesson1.sort_values(by='sort_key').drop(columns=['sort_key']) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "c2ab90fe-fae3-43e6-ad75-9e9e4cb0c763",
   "metadata": {},
   "outputs": [],
   "source": [
    "# 모든 컬럼 이름을 변경\n",
    "new_columns = [freesurfer_lut.get(int(col), 'Unknown') if col != 'subject' else 'subject' for col in sesson2.columns]\n",
    "\n",
    "\n",
    "sesson2.columns = new_columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "aba3780e-a7ae-411c-8d22-211715dd2043",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/tmp/ipykernel_3198212/1960010514.py:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  sesson2['sort_key'] = sesson2['subject'].apply(extract_number)\n"
     ]
    }
   ],
   "source": [
    "\n",
    "sesson2['sort_key'] = sesson2['subject'].apply(extract_number)\n",
    "volume_df_sorted2 = sesson2.sort_values(by='sort_key').drop(columns=['sort_key'])  \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "d69a72ce-b53f-40ea-b228-af9dcb1cd1c7",
   "metadata": {},
   "outputs": [],
   "source": [
    "def update_df_columns_keep_others(df, roi_dict):\n",
    "    # 합쳐진 컬럼들의 원본 컬럼 이름을 저장할 리스트\n",
    "    columns_to_remove = []\n",
    "    \n",
    "    # ROI 딕셔너리에 기반하여 합치는 작업을 수행\n",
    "    for roi, sub_columns in roi_dict.items():\n",
    "        # 해당 ROI에 속하는 데이터프레임의 컬럼들 찾기\n",
    "        relevant_columns = [col for col in df.columns if col.split(' ')[0] in sub_columns]\n",
    "        \n",
    "        # 해당 컬럼들이 데이터프레임에 있는 경우, 합쳐진 컬럼 생성\n",
    "        if relevant_columns:\n",
    "            # 합산 전에 NaN 값을 0으로 변환\n",
    "            df[roi] = df[relevant_columns].fillna(0).sum(axis=1)\n",
    "            # 원본 컬럼 이름을 제거 리스트에 추가\n",
    "            columns_to_remove.extend(relevant_columns)\n",
    "    \n",
    "    # 모든 ROI 컬럼들을 포함하는 리스트 생성\n",
    "    all_roi_columns = set()\n",
    "    for sub_columns in roi_dict.values():\n",
    "        all_roi_columns.update(sub_columns)\n",
    "    \n",
    "    # 제거할 컬럼 리스트에서, 딕셔너리에 정의된 컬럼만 실제로 제거\n",
    "    columns_to_remove = set([col for col in columns_to_remove if col.split(' ')[0] in all_roi_columns])\n",
    "    \n",
    "    # 실제로 제거할 컬럼들을 제거\n",
    "    df.drop(columns=columns_to_remove, inplace=True, errors='ignore')\n",
    "    \n",
    "    return df\n",
    "\n",
    "# 함수 실행하여 데이터프레임 업데이트\n",
    "new_df1 = update_df_columns_keep_others(volume_df_sorted1.copy(), combined_roi_dict)\n",
    "new_df2 = update_df_columns_keep_others(volume_df_sorted2.copy(), combined_roi_dict)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "3d0faaff-305e-40fc-882e-7c51ca746f88",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "brain_areas = set()\n",
    "left_right_columns = []\n",
    "\n",
    "for col in new_df1.columns:\n",
    "    if col.startswith('Left-') or col.startswith('Right-'):\n",
    "        left_right_columns.append(col)\n",
    "        brain_area = col.split('-', 1)[1]\n",
    "        brain_areas.add(brain_area)\n",
    "\n",
    "\n",
    "for area in brain_areas:\n",
    "    left_col = f'Left-{area}'\n",
    "    right_col = f'Right-{area}'\n",
    "    new_df1[area] = new_df1.get(left_col, 0) + new_df1.get(right_col, 0)\n",
    "\n",
    "volume_df_sorted1_final = new_df1.drop(columns=[col for col in left_right_columns if col not in ['subject']])\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "0d57d6df-2f30-405f-8bad-7e32d11f2235",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df_sorted1_final= volume_df_sorted1_final.drop(columns = ['Unknown 0 0 0 0','choroid-plexus 0 200 200 0','choroid-plexus 0 200 221 0','WM-hypointensities 200 70 255 0']) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "25eeb76b-764c-40a0-9b93-9323d9f71a86",
   "metadata": {},
   "outputs": [],
   "source": [
    "brain_areas = set()\n",
    "left_right_columns = []\n",
    "\n",
    "for col in new_df2.columns:\n",
    "    if col.startswith('Left-') or col.startswith('Right-'):\n",
    "        left_right_columns.append(col)\n",
    "        brain_area = col.split('-', 1)[1]\n",
    "        brain_areas.add(brain_area)\n",
    "\n",
    "\n",
    "for area in brain_areas:\n",
    "    left_col = f'Left-{area}'\n",
    "    right_col = f'Right-{area}'\n",
    "    new_df2[area] = new_df2.get(left_col, 0) + new_df2.get(right_col, 0)\n",
    "\n",
    "volume_df_sorted2_final = new_df2.drop(columns=[col for col in left_right_columns if col not in ['subject']])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "fd5c81f9-1f1e-4f18-b854-994f4cecfd48",
   "metadata": {},
   "outputs": [],
   "source": [
    "volume_df_sorted2_final= volume_df_sorted2_final.drop(columns = ['Unknown 0 0 0 0','choroid-plexus 0 200 200 0','choroid-plexus 0 200 221 0','WM-hypointensities 200 70 255 0']) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "e875708d-a204-44bc-8ff8-bdbf188fbf0e",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "all_data = pd.concat([volume_df_sorted1_final,volume_df_sorted2_final])\n",
    "all_data_long = pd.melt(all_data, id_vars=[\"subject\"], var_name=\"ROI\", value_name=\"Volume\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "c2b3e45a-75cc-410b-814c-f7aa5ab4a9f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "all_data_long['Session'] = all_data_long['subject'].str.extract(r'(session_\\d+)')\n",
    "\n",
    "\n",
    "all_data_long['ROI'] = all_data_long['ROI'].str.extract(r'([a-zA-Z-_]+)')[0]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "8438e2d2-9773-4bc2-90a2-eb7abde034e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "all_data_long['Subject_ID'] = all_data_long['subject'].str.extract(r'(\\d+)')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "31fca7b2-a74a-4000-abfe-e762421c405a",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "re_long = all_data_long.dropna(subset=['Volume'])\n",
    "\n",
    "\n",
    "grouped = re_long.groupby(['Subject_ID', 'ROI'])['Volume'].agg(['mean', 'var', 'std']).reset_index()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "bfca1540-1176-4721-8622-683c5882a4ce",
   "metadata": {},
   "outputs": [],
   "source": [
    "grouped['CV'] = grouped['std'] / grouped['mean']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "0a3bcf1f-f351-4c62-9588-ebcbb1300b78",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROI</th>\n",
       "      <th>Mean_CV</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Accumbens-area</td>\n",
       "      <td>0.013030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Amygdala</td>\n",
       "      <td>0.009356</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Brain-Stem</td>\n",
       "      <td>0.006476</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>CSF</td>\n",
       "      <td>0.017908</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Caudate</td>\n",
       "      <td>0.008217</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Cerebellum</td>\n",
       "      <td>0.007167</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Cingulate</td>\n",
       "      <td>0.012173</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Combined-Cerebral-WM</td>\n",
       "      <td>0.005655</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Frontal</td>\n",
       "      <td>0.013197</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Hippocampus</td>\n",
       "      <td>0.008582</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Insula</td>\n",
       "      <td>0.009831</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Occipital</td>\n",
       "      <td>0.011743</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Pallidum</td>\n",
       "      <td>0.019902</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Parietal</td>\n",
       "      <td>0.012881</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Putamen</td>\n",
       "      <td>0.004271</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Temporal</td>\n",
       "      <td>0.010760</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Thalamus</td>\n",
       "      <td>0.007838</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Total-Lateral-Ventricle</td>\n",
       "      <td>0.019462</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>VentralDC</td>\n",
       "      <td>0.008195</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>rd-Ventricle</td>\n",
       "      <td>0.015609</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>th-Ventricle</td>\n",
       "      <td>0.017514</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                        ROI   Mean_CV\n",
       "0            Accumbens-area  0.013030\n",
       "1                  Amygdala  0.009356\n",
       "2                Brain-Stem  0.006476\n",
       "3                       CSF  0.017908\n",
       "4                   Caudate  0.008217\n",
       "5                Cerebellum  0.007167\n",
       "6                 Cingulate  0.012173\n",
       "7      Combined-Cerebral-WM  0.005655\n",
       "8                   Frontal  0.013197\n",
       "9               Hippocampus  0.008582\n",
       "10                   Insula  0.009831\n",
       "11                Occipital  0.011743\n",
       "12                 Pallidum  0.019902\n",
       "13                 Parietal  0.012881\n",
       "14                  Putamen  0.004271\n",
       "15                 Temporal  0.010760\n",
       "16                 Thalamus  0.007838\n",
       "17  Total-Lateral-Ventricle  0.019462\n",
       "18                VentralDC  0.008195\n",
       "19             rd-Ventricle  0.015609\n",
       "20             th-Ventricle  0.017514"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "roi_mean_cv = grouped.groupby('ROI')['CV'].mean().reset_index()\n",
    "roi_mean_cv.rename(columns={'CV': 'Mean_CV'}, inplace=True)\n",
    "\n",
    "roi_mean_cv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "2fc8ad6f-5a6a-455c-9419-c32a983bc154",
   "metadata": {},
   "outputs": [],
   "source": [
    "grouped.to_csv(\"Simen_after_CV_individual_freesurfer_session.csv\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0bd025a1-285d-493c-ba3c-cf48a2ef63f3",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
